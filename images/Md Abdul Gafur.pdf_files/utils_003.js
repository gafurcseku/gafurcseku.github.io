define(["require","exports","modules/clean/ajax","modules/core/browser","modules/clean/sharing/api/client","modules/constants/file_viewer","modules/clean/file_store/utils","modules/clean/viewer","modules/clean/react/paper/paper_log","modules/core/i18n","modules/clean/react/bubble_dropdown_v2","modules/core/notify","modules/clean/react/size_class/constants","modules/clean/react/sign_in/utils"],function(e,o,r,n,t,i,s,a,l,p,c,d,u,f){"use strict";function _(e){var o=e.file,r=e.sharedLink;return m(e)?P(o)?r?I.Button:I.Dropdown:I.Ellipsis:I.Off}function h(e){return e===I.Dropdown||e===I.Ellipsis?c.BubbleDropdownPositions.BOTTOM_LEFT:c.BubbleDropdownPositions.BOTTOM}function b(){return"ON"===i.EMBED_TO_PAPER_ONBOARDING_VARIANT}function m(e){var o=e.file,r=e.user,t=e.sharedLink;return!!o&&((P(o)&&v.includes(i.OPEN_IN_PAPER_VARIANT)||g(o)&&"ON"===i.EMBED_TO_PAPER_FETCH_MATTE_VARIANT||A(o)&&B.includes(i.EMBED_TO_PAPER_VARIANT))&&!a.Viewer.get_viewer().is_assume_user_session&&!n.is_mobile_or_tablet()&&n.is_supported_paper_browser()&&(!r&&!!t||!!r&&!r.is_paper_disabled))}function g(e){var o=s.getExtension(e);return!!o&&L.includes(o)}function A(e){var o=s.getExtension(e);return!!o&&R.includes(o)}function P(e){var o=s.getExtension(e);return!!o&&(N.includes(o)&&e.bytes<20971520)}function T(e){var o=p._("Copy to Paper");return A(e)&&(o=p._("Add to Paper doc")),o}function x(e){return g(e)?p._("Share specific pages from this file using Dropbox Paper."):p._("Collect ideas and connect all kinds of files in a single doc.")}function E(e,o){return o===u.SizeClass.Large&&(A(e)||g(e))}function w(e){return g(e)?p._("New! Share specific pages"):A(e)?p._("Bring it all together"):p._("Bring this doc to life")}function O(e){return g(e)?p._("Help others focus on what’s important by sharing specific pages from this file. Try it now in Dropbox Paper."):A(e)?p._("Add this file to a Paper doc to collect ideas and organize your thoughts."):p._("Copy to Paper and make changes or ask for feedback.")}function k(e){var o=e.file,n=e.sharedLink,t=e.contUrl,i=e.successCallback,s=e.errorCallback,a=e.extension,l=e._tk,p=e.oqa,c=e.fromModal;r.WebRequest({url:"/paper/sign_request_data",data:{path:o.file_id,sharedLink:n,cont_url:t,extension:a,_tk:l,oqa:p,fromModal:c},success:i,error:s})}function C(e){var o=e.file,r=e.user,i=e.fromModal;if(!r)return void n.redirect(f.getSignInAndContinueUrl());var a=window.open("","_blank"),c=function(e){a?n.redirect(e,a):n.redirect(e)},u=function(){a&&a.close(),d.Notify.error(p._("Can’t copy file to Paper"))},_=e.sharedLink?e.sharedLink:"",h=e.sharedLink?"shared_file_actions":"mounted_file_actions",b=s.getExtension(o);l.paperLog(l.PaperEventTypes.CTA_CLICK,{source:h,cta:"open_in_paper_button",extension:b});var m=b,g={file:o,sharedLink:_,contUrl:"/create-doc-from-dropbox-file",extension:b,successCallback:c,errorCallback:u,_tk:"dropbox_web_copy_from_previews",oqa:m,fromModal:i};if(P(o))k(g);else if(g._tk="dropbox_web_embed_from_previews",!_&&r){var A=new t.FileShareApiClient({userId:r.id});A.sharedLinkInfo({fileIdOrPath:o.file_id}).then(function(e){e?(g.sharedLink=e.url,g.contUrl="/dropbox-file-embed",k(g)):A.createSharedLink({fileIdOrPath:o.file_id}).then(function(e){g.sharedLink=e.url,g.contUrl="/dropbox-file-embed",k(g)}).catch(function(e){u&&u()})}).catch(function(e){u&&u()})}else g.contUrl="/dropbox-file-embed",k(g)}Object.defineProperty(o,"__esModule",{value:!0});var I,v=["VARIANT_A","VARIANT_B1","VARIANT_B2","VARIANT_B3","VARIANT_B4","ON"],B=["BUTTON","DROPDOWN","ELLIPSIS"],N=["docx"],L=["ppt","pptx","pptm","pps","ppsx","ppsm","odp","pdf","ai"],R=["jpg","jpeg","png","pdf","xls","xlsx","mp4","mov","pptx","ppt","zip","rar","mp3"];(function(e){e[e.Off=1]="Off",e[e.Control=2]="Control",e[e.Button=3]="Button",e[e.Dropdown=4]="Dropdown",e[e.Ellipsis=5]="Ellipsis"})(I=o.OpenInPaperButtonVariant||(o.OpenInPaperButtonVariant={})),o.getOpenInPaperButtonVariant=_,o.getCalloutPosition=h,o.shouldShowEmbedToPaperModal=b,o.shouldShowOpenInPaper=m,o.fileSupportsEmbedToPaperFetchMatte=g,o.fileSupportsEmbedToPaper=A,o.fileSupportsCopyToPaper=P,o.getCTAText=T,o.getCTATextDescription=x,o.shouldShowCTADescription=E,o.getCalloutTitle=w,o.getCalloutMessage=O,o.createPaperAccountAndRedirect=k,o.openFileInPaper=C});
//# sourceMappingURL=utils.min.js-vfl3I10ZZ.map