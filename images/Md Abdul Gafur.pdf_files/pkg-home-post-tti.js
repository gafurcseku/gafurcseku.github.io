define("modules/clean/cloud_docs/home_create_file_experiments_post_tti",["require","exports","tslib","external/react","modules/clean/react/home/store","modules/clean/cloud_docs/new_file_menu"],function(e,t,n,o,r,i){"use strict";function a(){return{expFileCreateHome:!1}}function s(e){return n.__awaiter(this,void 0,void 0,function(){var t,a;return n.__generator(this,function(n){return t=e.cloudDocsExperiments.expFileCreateHome,t?(a=[],a.push(function(){return o.createElement(i.NewFileMenu,{user:r.getUser(),disabled:!1,showGdd:!1})}),[2,new Promise(function(e,t){e(a)})]):[2,new Promise(function(e,t){e([])})]})})}Object.defineProperty(t,"__esModule",{value:!0}),t.getCloudDocsExperiments=a,t.getSecondaryItems=s}),define("modules/clean/fileops",["require","exports","tslib","jquery","modules/clean/ajax","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,o,r,i,a,s){"use strict";function c(e,t){var n=o.Deferred(),s=i.ungettext("Deleted %(file_count)s item.","Deleted %(file_count)s items.",t.length).format({file_count:t.length});return a.Notify.success(s),r.WebRequest({url:"/cmd/delete",data:{files:t},subject_user:e,success:function(e){n.resolve(e)},error:function(e){a.Notify.error(i._("Failed to perform the delete. Please try again later.")),n.reject(e)}}),n.promise()}function l(e,t,o){return void 0===o&&(o={}),o=n.__assign((r={},r._subject_uid=String(t),r),o),new s.URI({path:"/history"+e,query:o});var r}Object.defineProperty(t,"__esModule",{value:!0}),t.do_nonbrowse_delete=c,t.build_revisions_uri=l}),define("modules/clean/growth/experiments/prowth_home_experiments_post_tti",["require","exports","tslib"],function(e,t,n){"use strict";function o(t){return n.__awaiter(this,void 0,void 0,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["modules/clean/growth/experiments/overquota_helper"],t,n)})];case 1:return o=n.sent().OverquotaHelper,"V1"===t?o.showSubgrowthProOQNewFolderModal({oqa:"wb_oq_ad_shfo_ho"}):"CONTROL"===t&&o.logExposureSubgrowthProOQNewFolderModal("CONTROL"),[2]}})})}function r(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["modules/clean/growth/experiments/overquota_helper"],t,n)})];case 1:return t=n.sent().OverquotaHelper,[2,new Promise(function(e,n){return t.getVariantSubgrowthProOQNewFolder().then(function(t){e(t)})})]}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.experimentalHandleCreateSharedFolder=o,t.experimentalGetVariantSubgrowthProOQNewFolder=r}),define("modules/clean/react/home/banner/banner_content",["require","exports","tslib","external/react","spectrum/button","modules/clean/static_urls","modules/clean/react/image"],function(e,t,n,o,r,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(t){var n=e.call(this,t)||this;return n.renderCloseButton=function(){var e=n.props,t=e.showX,s=e.handleClose;return t?o.createElement(r.Button,{variant:"styleless",className:"home-access-banner-content__close-btn",onClick:s},o.createElement(a.Image,{src:i.static_url("/static/images/x-vflYKfRuL.png")})):null},n}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.content,i=e.title,a=e.subtitle,s=e.buttonText,c=e.buttonProps;return o.createElement("div",{className:"home-access-banner-content"},this.renderCloseButton(),o.createElement("div",{className:"home-access-banner-content__left"},o.createElement("div",{className:"home-access-banner-content__title"},i),o.createElement("div",{className:"home-access-banner-content__subtitle"},a),o.createElement("div",{className:"home-access-banner-content__btn-container"},o.createElement(r.Button,n.__assign({},c),s))),o.createElement("div",{className:"home-access-banner-content__right"},t))},t.displayName="BannerContent",t})(o.PureComponent);t.BannerContent=s}),define("modules/clean/react/home/banner/default_props",["require","exports"],function(e,t){"use strict";function n(){return{showMigrateBanner:!1,isPaperEnabledForUser:!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultBannerProps=n}),define("modules/clean/react/home/banner/migrate_banner_container",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/react/home/banner/banner_content","modules/clean/react/image","modules/clean/static_urls","modules/core/uri","modules/core/browser","modules/clean/analytics","modules/clean/storage","modules/clean/react/home/store"],function(e,t,n,o,r,i,a,s,c,l,u,d,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleClose=function(){d.UserLocalStorage.set(_.getUserId(),"show_biz_2001_modal",!1),n.setState({showBanner:!1})},n.handleCTAClick=function(){u.TeamsWebActionsLogger.log("biz_2001_modal_clicked"),l.open_tab(new c.URI({path:"/help/business/standard-added-space"}).toString())},n.showBannerStorage=d.UserLocalStorage.get(_.getUserId(),"show_biz_2001_modal"),n.state={showBanner:null==n.showBannerStorage||n.showBannerStorage},n}return n.__extends(t,e),t.prototype.componentDidMount=function(){null==this.showBannerStorage&&u.TeamsWebActionsLogger.log("biz_2001_modal_shown")},t.prototype.render=function(){var e=this.props.migrateBannerCopy;if(!this.state.showBanner||!e)return null;var t={className:"home-access-banner-content__button",size:"large",variant:"secondary",onClick:this.handleCTAClick};return o.createElement(i.BannerContent,{showX:!0,handleClose:this.handleClose,title:r._("Youâ€™re getting more space!"),subtitle:e,buttonProps:t,buttonText:r._("Learn more"),content:o.createElement(a.Image,{width:250,src:s.static_url("/static/images/home/banner/briefcase_walking-vflma_opM.png"),srcHiRes:s.static_url("/static/images/home/banner/briefcase_walking@2x-vflT8-fXO.png")})})},t.displayName="MigrateBannerContainer",t})(o.Component);t.MigrateBannerContainer=m}),define("modules/clean/react/home/experiments/calendar/default_props",["require","exports","modules/clean/react/home/store"],function(e,t,n){"use strict";function o(){return{userRole:n.getRole(),shouldShow:!1,isAuthed:!1,onboardingProps:{showJewelOnboarding:!1,showAttachDialog:!1,showSectionOnboarding:!1,attachmentOnboardingVariant:null,showDragOnboarding:!1,showHomeSurvey:!1},outlookEnabled:!1,suggestionsEnabled:!1,devFeaturesEnabled:!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultCalendarProtoData=o}),define("modules/clean/react/home/home_access/growth/default_props",["require","exports"],function(e,t){"use strict";function n(){return{expSubgrowthBizTeamsRecMembersHome:"OFF",expSubgrowthBizTeamsSuggestionsOnHome:"OFF",numRemainingLicenses:0,recommendedMembers:[]}}Object.defineProperty(t,"__esModule",{value:!0}),t.getHomeGrowthExperiments=n}),define("modules/clean/react/home/onboarding/actions_post_tti",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/home/onboarding/api_post_tti","modules/clean/react/home/onboarding/constants_post_tti","modules/clean/react/home/onboarding/store_post_tti","modules/clean/react/home/onboarding/tooltips_post_tti","modules/clean/react/home/util/constants_post_tti"],function(e,t,n,o,r,i,a,s){"use strict";function c(){n.Dispatcher.dispatch({type:r.HomeOnboardingActionTypes.SET_ONBOARDING_COMPLETE})}function l(){i.getHomeOnboardingStore().shouldShowUnreadOnboarding()&&a.showUnreadTooltipIfRendered()&&(o.hideUnreadOnboarding(),u(!1))}function u(e){n.Dispatcher.dispatch({type:r.HomeOnboardingActionTypes.UPDATE_SHOW_UNREAD_ONBOARDING,showUnreadOnboarding:e})}function d(e){var t=function(e){var t=window;"scrollBehavior"in document.documentElement.style?t.scroll({top:e,left:0,behavior:"smooth"}):t.scroll(0,e)},n=e.step;if(n)if(n.name===s.HOME_V1_USER_EDUCATION_STEP_NAMES.RECENTLY_VIEWED){var o=document.querySelector(".maestro-header"),r=document.querySelector(".home-recents-section"),i=void 0,a=void 0,c=void 0;o&&r&&(i=o.getBoundingClientRect(),a=r.getBoundingClientRect(),c=a.top-(i.height+i.top),t(c))}else n.name===s.HOME_V1_USER_EDUCATION_STEP_NAMES.FILES&&t(0)}Object.defineProperty(t,"__esModule",{value:!0}),t.markHomeOnboardingComplete=c,t.showUnreadOnboardingTooltipIfNecessary=l,t.updateShowUnreadOnboarding=u,t.handleHomeUserEducationStateSteps=d}),define("modules/clean/react/home/onboarding/api_post_tti",["require","exports","modules/clean/react/home/store","modules/clean/react/home/api"],function(e,t,n,o){"use strict";function r(){return o.makeRequest({url:"/home_feed/hide_unread_onboarding",type:"POST",data:{role:n.getHomeStore().getRole()}})}Object.defineProperty(t,"__esModule",{value:!0}),t.hideUnreadOnboarding=r}),define("modules/clean/react/home/onboarding/constants_post_tti",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeOnboardingActionTypes={SET_ONBOARDING_COMPLETE:"HOME_ONBOARDING_SET_ONBOARDING_COMPLETE",UPDATE_SHOW_UNREAD_ONBOARDING:"HOME_ONBOARDING_UPDATE_SHOW_UNREAD_ONBOARDING",PROMPT_MODAL_SHOWN:"HOME_ONBOARDING_PROMPT_MODAL_SHOWN"}}),define("modules/clean/react/home/onboarding/store_post_tti",["require","exports","tslib","external/lodash","modules/clean/flux/dispatcher","modules/clean/react/home/onboarding/constants_post_tti","modules/clean/flux/flux_store","modules/clean/upsell/prompt_event_emitter"],function(e,t,n,o,r,i,a,s){"use strict";function c(e){var t=e;return o.isFunction(t.didHomeModalLoad)&&t.didHomeModalLoad()}Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){var t=e.call(this,r.Dispatcher)||this;return t.isOnboardingComplete=!1,t.showUnreadOnboarding=!1,t.didPromptModalShow=!1,s.promptBufferedEventEmitter.on(s.Events.ON_PROMPT_INITIALIZED,function(e){c(e)&&r.Dispatcher.dispatch({type:i.HomeOnboardingActionTypes.PROMPT_MODAL_SHOWN})}),t}return n.__extends(t,e),t.prototype.getIsOnboardingComplete=function(){return this.isOnboardingComplete},t.prototype.shouldShowUnreadOnboarding=function(){return!this.didPromptModalShow&&this.showUnreadOnboarding&&this.getIsOnboardingComplete()},t.prototype.shouldDismissUnreadOnboardingModal=function(){return this.didPromptModalShow},t.prototype.onUpdateShowUnreadOnboarding=function(e){this.showUnreadOnboarding=e},t.prototype.onPromptModalShown=function(){this.didPromptModalShow=!0},t.prototype.__onDispatch=function(e){var t=e.action;switch(t.type){case i.HomeOnboardingActionTypes.PROMPT_MODAL_SHOWN:this.onPromptModalShown();break;case i.HomeOnboardingActionTypes.SET_ONBOARDING_COMPLETE:this.isOnboardingComplete=!0,this.__emitChange();break;case i.HomeOnboardingActionTypes.UPDATE_SHOW_UNREAD_ONBOARDING:this.onUpdateShowUnreadOnboarding(t.showUnreadOnboarding),this.__emitChange();break;default:return}},t})(a.FluxStore);t.HomeOnboardingStoreClass=l,t.getHomeOnboardingStore=o.once(function(){return new l})}),define("modules/clean/react/home/onboarding/tooltips_post_tti",["require","exports","modules/core/i18n","modules/clean/react/home/util/static_tooltip_post_tti","modules/clean/react/home/onboarding/store_post_tti"],function(e,t,n,o,r){"use strict";function i(e,t,n,i,a){var c=document.querySelector(e),l=r.getHomeOnboardingStore();if(c&&!l.shouldDismissUnreadOnboardingModal()){var u=new o.StaticTooltip,d=l.addListener(function(){l.shouldDismissUnreadOnboardingModal()&&(u.hide(),d())});return u.show(t,n,c,i,s,d,a),!0}return!1}function a(){return i(".home__unread-row--first .unread-item__title-group",n._("Tip"),n._("New shared files and comments show up here."),o.StaticTooltip.POSITIONS.RIGHT,"home-tooltip__unread-onboarding--list")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){return null};t.showUnreadTooltipIfRendered=a}),define("modules/clean/react/home/post_tti/interface",["require","exports","modules/clean/react/home/resource/actions_post_tti","modules/clean/react/home/starred/actions_post_tti","modules/clean/react/home/util/logging/unread_logger_post_tti","modules/clean/react/home/unread/home_access_unread_post_tti","modules/clean/react/home/roots/home_access_web_post_tti","modules/clean/react/home/recents/actions/recent_activity_actions_post_tti","modules/clean/react/home/recents/actions/recent_activity_actions_utils_post_tti","modules/clean/react/home/post_tti/unity_post_tti","modules/clean/react/home/recents/components/recent_activity_container_post_tti","modules/clean/react/home/recents/recent_activity_starred_post_tti","modules/clean/react/home/recents/store_utils_post_tti","modules/clean/react/home/unread/card_post_tti","modules/clean/react/home/unread/store_post_tti","modules/clean/react/home/recents/components/attachment_list_view_post_tti","modules/clean/sharing/async_share_modal_util","modules/clean/react/home/api_post_tti","modules/clean/react/home/post_tti/props_post_tti","modules/clean/react/home/util/feedback_button","modules/clean/react/home/roots/home_access_main_post_tti","modules/clean/react/home/onboarding/actions_post_tti","modules/clean/growth/experiments/prowth_home_experiments_post_tti","modules/clean/react/home/util/logging/availability_logger_post_tti","modules/clean/react/home/recents/recent_activity_client_post_tti","modules/clean/react/home/recents/recent_activity_logger_utils_post_tti","modules/clean/react/home/starred/actions_post_tti","modules/clean/react/home/unread/tasks_post_tti","modules/clean/react/home/recents/components/recent_filters_menu_post_tti","modules/clean/react/home/recents/recent_activity_filter_actions_post_tti","modules/clean/cloud_docs/home_create_file_experiments_post_tti","modules/clean/react/app_actions/app_actions_store","modules/clean/react/home/recents/recent_activity_file_action_post_tti","modules/clean/react/home/starred/starred_item_file_action_post_tti","modules/clean/react/home/experiments/home_suggest_grid/home_suggest"],function(e,t,n,o,r,i,a,s,c,l,u,d,_,m,p,h,f,g,v,y,E,I,b,w,A,S,T,O,N,R,P,D,C,x,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openInFileViewer=n.openInFileViewer,t.createAutoShareLink=n.createAutoShareLink,t.getStarredStatusMetadata=o.getStarredStatusMetadata,t.logOpenUnreadNotificationItem=r.logOpenUnreadNotificationItem,t.logMarkNotificationAsRead=r.logMarkNotificationAsRead,t.logRenderedNotifications=r.logRenderedNotifications,t.triggerUnreadOnboarding=i.triggerUnreadOnboarding,t.homeAccessWebComponentDidMount=a.homeAccessWebComponentDidMount,t.openFile=s.openFile,t.downloadFiles=s.downloadFiles,t.openVersions=s.openVersions,t.shareFile=s.shareFile,t.previewFileSyncRecentItem=s.previewFileSyncRecentItem,t.deleteRecentItem=s.deleteRecentItem,t.openAttachment=s.openAttachment,t.deleteAttachments=c.deleteAttachments,t.getUnityFeatures=l.getUnityFeatures,t.recentActivityContainerComponentDidMount=u.recentActivityContainerComponentDidMount,t.setStarredStatusOfPaperRecentItems=d.setStarredStatusOfPaperRecentItems,t.fetchStarredStatus=d.fetchStarredStatus,t.ensureAttachments=_.ensureAttachments,t.loadPaperRecentItems=_.loadPaperRecentItems,t.loadRecentItems=_.loadRecentItems,t.acknowledgeNotification=m.acknowledgeNotification,t.listenToAndGetNotificationStore=p.listenToAndGetNotificationStore,t.AttachmentListView=h.AttachmentListView,t.asyncShowShareModal=f.asyncShowShareModal,t.createPaperDoc=g.createPaperDoc,t.setSectionVisibility=g.setSectionVisibility,t.getPostTTIProps=v.getPostTTIProps,t.FeedbackButton=y.FeedbackButton,t.initHomeOnboarding=E.initHomeOnboarding,t.showUnreadOnboardingTooltipIfNecessary=I.showUnreadOnboardingTooltipIfNecessary,t.experimentalGetVariantSubgrowthProOQNewFolder=b.experimentalGetVariantSubgrowthProOQNewFolder,t.experimentalHandleCreateSharedFolder=b.experimentalHandleCreateSharedFolder,t.logHomeAvailability=w.logHomeAvailability,t.archivePaperResources=A.archivePaperResources,t.postLogEvent=A.postLogEvent,t.logOpenPathUrl=S.logOpenPathUrl,t.openUrl=S.openUrl,t.logRequestFailed=S.logRequestFailed,t.logRecentsLoaded=S.logRecentsLoaded,t.loadAllStarredItems=T.loadAllStarredItems,t.Tasks=O.Tasks,t.RecentFiltersMenu=N.RecentFiltersMenu,t.getAvailableFiltersFromRecentItems=R.getAvailableFiltersFromRecentItems,t.processRecentItems=R.processRecentItems,t.getSecondaryItems=P.getSecondaryItems,t.getAppActionsStore=D.getAppActionsStore,t.RecentActivityFileActionPost=C.RecentActivityFileActionPost,t.StarredItemFileActionPost=x.StarredItemFileActionPost,t.HomeSuggest=F.HomeSuggest,t.initPrefetch=F.initPrefetch}),define("modules/clean/react/home/post_tti/props_post_tti",["require","exports","modules/clean/cloud_docs/home_create_file_experiments_post_tti","modules/clean/react/home/util/prefetch_handler","modules/clean/react/home/experiments/calendar/default_props","modules/clean/react/home/banner/default_props","modules/clean/react/home/home_access/growth/default_props","modules/core/exception","modules/clean/react/home/util/constants_post_tti","external/lodash"],function(e,t,n,o,r,i,a,s,c,l){"use strict";function u(){return{calendarProtoData:r.getDefaultCalendarProtoData(),bannerProps:i.getDefaultBannerProps(),onboardingData:c.DEFAULT_ONBOARDING_POST_TTI_PROPS,renderSnapEngage:!1,maybeRenderTeamAdminModals:!1,searchBarExperiments:{},homeGrowthExperiments:a.getHomeGrowthExperiments(),uploaderPostTTIExperiments:{expProOQUploadModal:"OFF"},tasks:{forMe:[],forOthers:[],completed:[]},cloudDocsExperiments:n.getCloudDocsExperiments()}}Object.defineProperty(t,"__esModule",{value:!0}),t.getPostTTIProps=l.once(function(){return new Promise(function(e){var t=o.getPrefetchHandler("__REGISTER_POST_TTI_PREFETCH_HANDLER"),n=function(){return e(u())};t?o.handlePrefetch(t,function(t){try{e(JSON.parse(t))}catch(e){s.reportStack("Failed to parse post TTI props",{severity:s.SEVERITY.CRITICAL,exc_extra:{error:e}}),n()}},function(e){s.reportStack("Post TTI prefetch failed",{severity:s.SEVERITY.CRITICAL,exc_extra:{error:e}}),n()}):n()})})}),define("modules/clean/react/home/post_tti/unity_post_tti",["require","exports","tslib"],function(e,t,n){"use strict";function o(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,new Promise(function(t,n){e(["modules/clean/unity/features"],t,n)})];case 1:return[2,n.sent()];case 2:return t=n.sent(),[2,null];case 3:return[2]}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.getUnityFeatures=o}),define("modules/clean/react/home/recents/actions/recent_activity_actions_post_tti",["require","exports","tslib","external/lodash","modules/clean/downloads","modules/clean/react/home/recents/recent_activity_logger_utils_post_tti","modules/clean/react/home/recents/store_utils_post_tti","modules/clean/react/home/recents/actions/recent_activity_actions_utils_post_tti","modules/clean/react/home/util/navigation","modules/clean/react/home/store","modules/core/exception","modules/core/exception","modules/core/notify","modules/clean/fileops","modules/clean/react/home/post_tti/unity_post_tti","modules/clean/react/home/resource/actions_post_tti","modules/clean/browse_uri_interface","modules/clean/react/home/recents/models/utils","modules/clean/sharing/async_share_modal_util","modules/clean/react/modal","modules/core/i18n","modules/clean/react/home/recents/stores/attachment_store","modules/clean/react/home/constants","modules/clean/react/home/recents/recent_activity_constants"],function(e,t,n,o,r,i,a,s,c,l,u,d,_,m,p,h,f,g,v,y,E,I,b,w){"use strict";function A(e,t,o){return n.__awaiter(this,void 0,void 0,function(){var r,c,u,d,_,m,p,f;return n.__generator(this,function(n){switch(n.label){case 0:return r=l.getUser(),[4,a.ensureAttachments([e],w.EnsureAttachmentsPurpose.SHARE_FILE)];case 1:return c=n.sent(),u=c[0],d=u.fqPath||"",_=u.previewInfo,m=_?_.target_ns:null,p=!1,o?(h.createAutoShareLink(r,d),p=!0,[3,4]):[3,2];case 2:return[4,v.asyncShowShareModal(r,{fqPath:d,isFolder:u.previewInfo.is_dir,origin:"RECENTS",targetNsId:m})];case 3:p=n.sent(),n.label=4;case 4:return t&&p&&(f=s.getFqPaths(c),i.logShareFile(r.id,d,t.totalCount,t.cellView),s.homeLogEvent(t,w.ActionType.SHARE,f,f.indexOf(d))),[2,p]}})})}function S(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,c,d,m,h,f,g,v;return n.__generator(this,function(n){switch(n.label){case 0:return[4,p.getUnityFeatures()];case 1:return r=n.sent(),u.assert(!!r,"Unity is not supported by this browser"),[4,a.ensureAttachments([e],w.EnsureAttachmentsPurpose.OPEN_FILE)];case 2:return c=n.sent(),d=c[0],m=d.nsId,h=d.nsPath,f=c[0].fqPath||"",g=l.getUserId(),r.open_file(m,h,g,o.noop,function(e){_.Notify.error("We were unable to open this file"),u.reportException({err:Error(e),tags:["recents"],severity:u.SEVERITY.NONCRITICAL})}),t&&(v=s.getFqPaths(c),i.logUnityOpenFile(g,f,t.totalCount,t.cellView),s.homeLogEvent(t,w.ActionType.OPEN,v,v.indexOf(f))),[2]}})})}function T(e,t,r,i){return n.__awaiter(this,void 0,void 0,function(){var i,a,c,l,u,_,m,p;return n.__generator(this,function(n){return i=e.federatedRecentItem,a=e.displayType,i?d.reportStack("Deleting is not supported for federated recent items",{severity:d.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e}}):(c=g.extractAttachmentIds(t),l=function(){return s.deleteAttachments(c,r)},u=void 0,_=void 0,1===c.length?(m=I.getAttachmentStore().getById(c[0]),m&&m.isLoaded?(_=m.isDir?E._("Delete folder?"):E._("Delete file?"),p=a===b.DisplayTypes.SHARED_FOLDER?E._("Are you sure you want to remove the shared folder <b>%(file_name)s</b> from your Dropbox? This shared folder will stay shared with other members and you can re-add it later."):E._("Do you want to delete <b>%(file_name)s</b>?"),u=p.format({file_name:o.escape(m.displayName||"")})):(_=E._("Delete file?"),u=E._("Do you want to delete this file?"))):(_=E._("Delete files?"),u=E._("Do you want to delete <b>%(num)s files</b>?").format({num:o.escape(String(c.length))})),y.SimpleModal.show({title_text:_,body_html:u,confirm_text:E._("Delete"),confirm_callback:l,cancel_text:E._("Cancel"),autoclose:!0})),[2]})})}function O(e,t){return n.__awaiter(this,void 0,void 0,function(){var o,c,u;return n.__generator(this,function(n){switch(n.label){case 0:return o=l.getUserId(),[4,a.ensureAttachments(e,w.EnsureAttachmentsPurpose.DOWNLOAD_FILES)];case 1:return c=n.sent(),t&&(u=s.getFqPaths(c),i.logDownloadFile(o,u,t.totalCount,t.cellView),s.homeLogEvent(t,w.ActionType.DOWNLOAD,u)),c.forEach(function(e){if(e.isDir&&e.fqPath&&null!=e.previewInfo&&null!=e.previewInfo.block_hash)r.get_zip({fq_paths:[e.fqPath],subject_uid:o,block_hash:e.previewInfo.block_hash,parent_path:e.fqPath});else{var t=null!=e.previewInfo?e.previewInfo.direct_blockserver_link:void 0;t&&r.get_blockserver_link({url:t})}}),[2]}})})}function N(e,t,o){return n.__awaiter(this,void 0,void 0,function(){var r,u,d,_,p,h;return n.__generator(this,function(n){switch(n.label){case 0:return r=l.getUserId(),[4,a.ensureAttachmentsWithRetryStatus([t],w.EnsureAttachmentsPurpose.OPEN_VERSIONS)];case 1:return u=n.sent(),d=u.attachments,_=u.isRetry,p=d[0].fqPath||"",h=m.build_revisions_uri(p,r),c.logAndNavigate(h.toString(),o?function(){var e=s.getFqPaths(d);return i.logOpenVersions(r,p,o.totalCount,o.cellView),s.homeLogEvent(o,w.ActionType.VERSIONS,e,e.indexOf(p))}:void 0,_?c.NavigationMethod.REDIRECT:e),[2]}})})}function R(e){return{shouldFocusCommentInput:e.shouldFocusCommentInput,index:e.index,shouldUseEntityUri:e.shouldUseEntityUri}}function P(e,t,o,r){return n.__awaiter(this,void 0,void 0,function(){var s,c,l,u,_;return n.__generator(this,function(n){switch(n.label){case 0:return[4,a.ensureAttachmentsWithRetryStatus([e.attachmentIds[0]],w.EnsureAttachmentsPurpose.PREVIEW_RECENT_ITEM)];case 1:if(s=n.sent(),c=s.attachments,l=s.isRetry,1===c.length){if(u=c[0],_=C(u,e.attachmentIds,r,t&&!l,o.shouldFocusCommentInput))return[2];if(o.shouldUseEntityUri&&u.entityUri)return i.openTab(u.entityUri,w.ActionType.VIEW_FILE,e.attachmentIds,r),[2]}return d.reportStack("Preview failed",{severity:d.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e,attachments:c,previewOptions:R(o)}}),[2]}})})}function D(e,t){return e.fqPath?String(f.preview_uri_for_fq_path(t,e.fqPath)):e.previewInfo?e.previewInfo.href||null:null}function C(e,t,n,o,r){if(e.isDir||o){var a=D(e,l.getHomeStore().getUser());return!!a&&(i.openTab(a,w.ActionType.VIEW_FILE,t,n),!0)}return h.openInFileViewer(e.id,function(){return i.logRecentActivityAction(w.ActionType.VIEW_FILE,t,n)},r),!0}function x(e,t,n,o){C(t.find(function(t){return t.id===e}),g.extractAttachmentIds(t),o,c.isMetaKeyPressed(n))}Object.defineProperty(t,"__esModule",{value:!0}),t.shareFile=A,t.openFile=S,t.deleteRecentItem=T,t.downloadFiles=O,t.openVersions=N,t.previewFileSyncRecentItem=P,t.openAttachment=C,t.previewAttachment=x}),define("modules/clean/react/home/recents/actions/recent_activity_actions_utils_post_tti",["require","exports","tslib","external/lodash","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/recent_activity_logger_utils_post_tti","modules/clean/react/home/store","modules/clean/react/home/recents/store_utils_post_tti","modules/clean/fileops","modules/clean/react/home/recents/utils/events"],function(e,t,n,o,r,i,a,s,c,l,u){"use strict";function d(e){return o.compact(o.map(e,"fqPath"))}function _(e,t,n,o){return u.logEvent(t,e.cellView,n,e.totalCount,o)}function m(e,t){return n.__awaiter(this,void 0,void 0,function(){var u,m,p,h,f,g,v,y;return n.__generator(this,function(n){switch(n.label){case 0:return u=s.getUserId(),[4,c.ensureAttachments(e,r.EnsureAttachmentsPurpose.PROMPT_AND_DELETE_ATTACHMENTS)];case 1:return m=n.sent(),p=d(m),t&&(h=t.totalCount,f=t.cellView,a.logDeleteFiles(u,p,h,f),_(t,r.ActionType.DELETE,p,void 0)),g=o.uniqueId("DELETE_FILES"),i.recentActivityDispatcher.dispatch({type:r.DELETE_FILES_PENDING,attachmentIds:e,transactionId:g}),v=function(){return i.recentActivityDispatcher.dispatch({type:r.DELETE_FILES_COMMIT,transactionId:g})},y=function(){return i.recentActivityDispatcher.dispatch({type:r.DELETE_FILES_ROLLBACK,transactionId:g})},l.do_nonbrowse_delete(u,p).then(v,y),[2]}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.getFqPaths=d,t.homeLogEvent=_,t.deleteAttachments=m}),define("modules/clean/react/home/recents/components/attachment_file_icon_view_post_tti",["require","exports","tslib","external/classnames","external/react","external/lodash","modules/clean/em_string","modules/clean/react/home/util/resource_icon"],function(e,t,n,o,r,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){e.preventDefault(),t.props.handleClick(t.props.id,e)},t.onContextMenu=function(e){e.preventDefault(),t.props.handleContextMenu(t.props.id)},t}return n.__extends(t,e),t.prototype.renderFilename=function(){var e=this.props.file.displayName.split("."),t="."+e.pop(),n=a.Emstring.em_snippet(e.join("."),10);return r.createElement("span",{className:"attachment-item__filename"},n,r.createElement("wbr",null),r.createElement("span",{className:"nowrap"},t))},t.prototype.renderIcon=function(){return r.createElement(s.HomeResourceIcon,{className:"attachment-item__icon",displayType:this.props.file.displayType,fileName:this.props.file.displayName})},t.prototype.render=function(){var e=this.props,t=e.overlayText,n=e.file;return r.createElement("div",{className:o({"attachment-item":!0,"attachment-item--file-thumb":!0,"attachment-item--show-more":!!t})},r.createElement("a",{href:n.entityUri,title:n.displayName,className:"attachment-item__anchor",onClick:this.onClick,onContextMenu:this.onContextMenu},this.renderIcon(),this.renderFilename(),t?r.createElement("span",{className:"attachment-item__overlay"},t):void 0))},t.defaultProps={handleClick:i.noop,handleContextMenu:i.noop},t})(r.Component);t.AttachmentFileIconView=c}),define("modules/clean/react/home/recents/components/attachment_grid_post_tti",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){this._gridWidth=e,this._gutterWidth=t}return e.create=function(t,n){return new e(t,n)},e.prototype.generate=function(e,t){void 0===t&&(t=1/0);for(var n=[],o=0;n.length<t&&o<e.length;){var r=this.buildRow(e.slice(o));o+=r.length,n.push(r)}return n},e.prototype.buildRow=function(e){for(var t=[],n=this._gridWidth+this._gutterWidth,o=0,r=e;o<r.length;o++){var i=r[o];if(n=n-i.width-this._gutterWidth,!(n>=0||0===t.length))break;t.push(i)}return t},e})();t.AttachmentGrid=n}),define("modules/clean/react/home/recents/components/attachment_image_view_post_tti",["require","exports","tslib","external/classnames","external/react"],function(e,t,n,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isLoading:!0},t.onClick=function(e){e.preventDefault(),t.props.handleClick(t.props.id,e)},t.onContextMenu=function(e){e.preventDefault(),t.props.handleContextMenu(t.props.id)},t.onLoad=function(){t.setState({isLoading:!1})},t.onError=function(){t.props.handleLoadError(t.props.id),t.setState({isLoading:!1})},t}return n.__extends(t,e),t.prototype.render=function(){var e,t=this.props,n=t.overlayText,i=t.image;return n&&(e=r.createElement("span",{className:"attachment-item__overlay"},n)),r.createElement("div",{className:o({"attachment-item":!0,"attachment-item--show-more":!!n,"attachment-item--is-loading":this.state.isLoading})},r.createElement("a",{href:i.entityUri,onClick:this.onClick,onContextMenu:this.onContextMenu,title:i.displayName,className:"attachment-item__anchor",style:{width:i.width,height:i.height},tabIndex:0},r.createElement("img",{alt:i.displayName,className:"attachment-item__thumbnail",src:i.thumbnailUrl,onLoad:this.onLoad,onError:this.onError}),e))},t.defaultProps={handleClick:function(){},handleContextMenu:function(){},handleLoadError:function(){}},t})(r.PureComponent);t.AttachmentImageView=i}),define("modules/clean/react/home/recents/components/attachment_list_layout_post_tti",["require","exports","external/lodash","modules/clean/photos/thumbnail_url_util","modules/clean/react/home/recents/components/attachment_file_icon_view_post_tti","modules/clean/react/home/recents/components/attachment_grid_post_tti","modules/clean/react/home/recents/components/attachment_image_view_post_tti","modules/core/browser","modules/core/exception"],function(e,t,n,o,r,i,a,s,c){"use strict";function l(e,t){var n,r,i,a=s.is_high_density_display();switch(t){case"aggregated-scaled":i=a?200:100,n=a?200:100,r=u;break;case"aggregated-cropped":i=a?200:100,n=a?200:100,r=d;break;case"aggregated-wide-cropped":i=a?718:359,n=a?200:100,r=d;break;default:return c.assert(!1,"invalid ThumbnailVariant: "+t),""}return o.thumbnailUrlForSize(e,i,n,r)}Object.defineProperty(t,"__esModule",{value:!0});var u=o.ThumbnailSizeMode.FIT_ONE,d=o.ThumbnailSizeMode.EXACT_NO_BACKGROUND,_=(function(){function e(e,t,n){this.gridWidth=e,this.columnWidth=t,this.gutterWidth=n,this._grid=i.AttachmentGrid.create(this.gridWidth,this.gutterWidth)}return e.create=function(t,n,o){return new e(t,n,o)},e.prototype.generate=function(e,t,n){var o=this.cellMetadata(e,n);return this._grid.generate(o,t)},e.prototype.cellMetadata=function(e,t){var o=this,r=n.zipObject(t,t);return e.map(function(e){var t=e.isLoaded,n=e.thumbnailUrl;return r[e.id]||t&&!n?o.buildFileIconViewMetadata(e):t?o.buildImageViewMetadata(e):o.buildLoadingImageViewMetadata(e)})},e.prototype.buildFileIconViewMetadata=function(e){return{id:e.id,scaledThumbnailUrl:null,view:r.AttachmentFileIconView,width:92,height:100,attachment:e}},e.prototype.buildLoadingImageViewMetadata=function(e){return{id:e.id,scaledThumbnailUrl:null,view:null,width:100,height:100,attachment:e}},e.prototype.buildImageViewMetadata=function(e){var t=e.thumbnailUrl,n=this.calculateThumbnailDimensions(e.thumbnailDimensions),o=n.width,r=n.height,i=n.variant;return t.startsWith("data:")||(t=l(t,i)),{id:e.id,
view:a.AttachmentImageView,scaledThumbnailUrl:t,width:o+6,height:r+6,attachment:e}},e.prototype.calculateThumbnailDimensions=function(e){var t,n,o;if(e){o="aggregated-scaled";var r=e.width/e.height;t=100,n=Math.floor(r*t),n>this.columnWidth-6&&(o="aggregated-wide-cropped",n=this.columnWidth-6)}return(!e||n<75)&&(o="aggregated-cropped",n=100,t=100),{width:n,height:t,variant:o}},e})();t.AttachmentListLayout=_}),define("modules/clean/react/home/recents/components/attachment_list_view_post_tti",["require","exports","tslib","external/react","external/lodash","modules/clean/components/loading_indicator","modules/clean/react/home/constants","modules/clean/react/home/recents/components/attachment_file_icon_view_post_tti","modules/clean/react/home/recents/components/attachment_image_view_post_tti","modules/clean/react/home/recents/components/attachment_list_layout_post_tti","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/actions/recent_activity_actions_post_tti","modules/clean/react/home/recents/store_utils_post_tti","modules/core/exception","modules/core/i18n"],function(e,t,n,o,r,i,a,s,c,l,u,d,_,m,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setAttachmentListRef=function(e){return t.attachmentsList=e},t.state={rows:1,errored:[],containerWidth:null,expandedAttachments:{}},t.previewAttachment=function(e,n){var o=t.props.attachments,r={totalCount:o.length,cellView:t};d.previewAttachment(e,o,n,r)},t.handleImageLoadError=function(e){var n=t.state.errored.slice();n.push(e),t.setState({errored:n})},t.revealNextGroup=function(){t.setState({rows:t.state.rows+u.SHOW_MORE_THUMBNAIL_ROW_INCREMENT})},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.updateLayoutController(),this.loadRemainingAttachments()},t.prototype.componentDidUpdate=function(e){this.updateLayoutController(),this.loadRemainingAttachments()},t.prototype.getLayoutProperties=function(e){var t=window.getComputedStyle(e),n=parseInt(t.width||"0",10),o=Math.abs(parseFloat(t.marginLeft||"0"))||0;return{containerWidth:n,maxWidthToFit:Math.floor(n/2)-o,itemHorizontalMargin:o}},t.prototype.updateLayoutController=function(){var e=this.getLayoutProperties(this.attachmentsList);e&&e.containerWidth!==this.state.containerWidth&&(this.layoutController=l.AttachmentListLayout.create(e.containerWidth,e.maxWidthToFit,e.itemHorizontalMargin),this.setState({containerWidth:e.containerWidth}))},t.prototype.loadRemainingAttachments=function(){var e=this.props.attachments.filter(function(e){return!e.isLoaded}).map(function(e){return e.id});e.length&&_.ensureAttachments(e,u.EnsureAttachmentsPurpose.LOAD_REMAINING_ATTACHMENTS)},t.prototype.isLoading=function(){return this.state.rows>1&&this.props.attachments.some(function(e){return!e.isLoaded})},t.prototype.renderAttachmentItems=function(){var e=this,t=this.props.attachments,n=this.state,i=n.containerWidth,l=n.errored;if(!i)return[];var u=this.isLoading()?1:this.state.rows,d=this.layoutController.generate(t,u,l),_=r.flattenDeep(d),h=this.previewAttachment,f=_.length,g=t.length,v=g-f+1,y=!this.isLoading()&&f<g;return _.map(function(t,n){var r,i;y&&n===_.length-1&&(h=e.revealNextGroup,i=p._("+%(count)s").format({count:v}));var l=t.attachment,u=t.view,d=t.id,f=t.scaledThumbnailUrl,g=t.width,E=t.height,I=l.entityUri,b=l.displayName,w=l.displayType;switch(u){case s.AttachmentFileIconView:r=o.createElement(s.AttachmentFileIconView,{key:"attachment-"+d,id:d,file:{displayName:b||"",displayType:w||a.DisplayTypes.FILE,entityUri:I||""},overlayText:i,handleClick:h});break;case c.AttachmentImageView:r=o.createElement(c.AttachmentImageView,{key:"attachment-expanded-"+d,overlayText:i,id:d,image:{thumbnailUrl:f,entityUri:I||"",displayName:b||"",width:g,height:E},handleClick:h,handleLoadError:e.handleImageLoadError});break;default:u&&m.assert(!1,u.name+" is not supported by AttachmentListView")}return o.createElement("li",{key:"attachment-item-"+l.id},r)})},t.prototype.renderLoadingView=function(){return o.createElement("div",{className:"attachment-loading"},o.createElement(i.LoadingIndicator,{style:i.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER,className:"recents-loading-indicator"}))},t.prototype.render=function(){var e=null;return this.isLoading()&&(e=this.renderLoadingView()),o.createElement("div",{className:"recents-item__attachments"},o.createElement("ul",{ref:this.setAttachmentListRef,className:"attachment-list"},this.renderAttachmentItems()),e)},t})(o.Component);t.AttachmentListView=h}),define("modules/clean/react/home/recents/components/recent_activity_container_post_tti",["require","exports","tslib","external/lodash","modules/clean/sharing/share_modal_util","modules/clean/sharing/wizard/wizard_modals"],function(e,t,n,o,r,i){"use strict";function a(e){var t=0,n=function(){var n=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,o=n/(document.documentElement.scrollHeight-window.innerHeight);o>.8&&o>t&&e(),t=o};window.addEventListener("scroll",o.throttle(n,150,{trailing:!1}),!1)}function s(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return a(o.throttle(e,2e3,{trailing:!1})),[2]})})}Object.defineProperty(t,"__esModule",{value:!0}),t.generateModalSessionId=r.generateModalSessionId,t.shareExistingFolder=i.shareExistingFolder,t.recentActivityContainerComponentDidMount=s}),define("modules/clean/react/home/recents/components/recent_filters_menu_post_tti",["require","exports","tslib","external/react","external/lodash","modules/core/i18n","spectrum/popover","modules/clean/react/home/util/section_header_menu_title","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/recent_activity_constants"],function(e,t,n,o,r,i,a,s,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RECENT_ITEMS_FILTER_TYPE_TO_STRING=(d={},d[l.RecentItemsFilterType.INCLUDE_OPEN_ACTIONS]=i._("Opened Items"),d[l.RecentItemsFilterType.INCLUDE_EDIT_ACTIONS]=i._("Edited Items"),d[l.RecentItemsFilterType.INCLUDE_ADD_ACTIONS]=i._("Added Items"),d[l.RecentItemsFilterType.INCLUDE_FILES]=i._("Files"),d[l.RecentItemsFilterType.INCLUDE_FOLDERS]=i._("Folders"),d[l.RecentItemsFilterType.INCLUDE_PAPER_DOCS]=i._("Paper docs"),d);var u=(function(e){function u(t){var n=e.call(this,t)||this;return n.handleFilterChange=function(e){var t=n.state.activeFilters,o=n.isFilterSelected(e)?r.without(t,e):t.concat([e]);c.recentActivityDispatcher.dispatch({type:l.SET_ACTIVE_FILTERS,activeFilters:o}),n.setState({activeFilters:o})},n.state={activeFilters:[]},n}return n.__extends(u,e),u.prototype.isFilterSelected=function(e){return this.state.activeFilters.includes(e)},u.prototype.renderAvailableFilters=function(e){var n=this;return e.map(function(e){return o.createElement(a.PopoverSelectableItem,{key:e,value:e,selected:n.isFilterSelected(e)},t.RECENT_ITEMS_FILTER_TYPE_TO_STRING[e])})},u.prototype.render=function(){var e=this.props,t=e.title,n=e.availableFilters;return o.createElement(a.Popover,{onSelection:this.handleFilterChange,closeOnSelection:!1},o.createElement(a.PopoverTrigger,{className:"section-header-trigger"},o.createElement(s.SectionHeaderMenuTitle,{title:t})),o.createElement(a.PopoverContent,null,o.createElement(a.PopoverItemGroup,null,o.createElement(a.PopoverItemGroupTitle,null,i._("Show")),o.createElement(a.PopoverSelectableItem,{selected:!this.isFilterSelected(l.RecentItemsFilterType.EXPAND_AGGREGATIONS),value:l.RecentItemsFilterType.EXPAND_AGGREGATIONS},i._("Images in groups"))),o.createElement(a.PopoverContentSeparator,null),o.createElement(a.PopoverItemGroup,null,o.createElement(a.PopoverItemGroupTitle,null,i._("Filter By")),this.renderAvailableFilters(n))))},u.displayName="RecentFiltersMenu",u})(o.PureComponent);t.RecentFiltersMenu=u;var d}),define("modules/clean/react/home/recents/models/utils_post_tti",["require","exports","modules/clean/react/home/constants","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/models/utils"],function(e,t,n,o,r){"use strict";function i(e){return r.getRecentItemActionType(e)===o.RecentItemActionType.OPENED}function a(e){return r.getRecentItemActionType(e)===o.RecentItemActionType.EDITED}function s(e){return r.getRecentItemActionType(e)===o.RecentItemActionType.ADDED}function c(e){return!l(e)&&!u(e)}function l(e){switch(e.displayType){case n.DisplayTypes.FOLDER:case n.DisplayTypes.SHARED_FOLDER:case n.DisplayTypes.TEAM_FOLDER:case n.DisplayTypes.CDM_TEAM_MEMBER_FOLDER:case n.DisplayTypes.SHARED_FOLDER_READ_ONLY:case n.DisplayTypes.RESTRICTED_FOLDER:case n.DisplayTypes.PAPER_FOLDER:case n.DisplayTypes.PAPER_PUBLIC_FOLDER:return!0;default:return!1}}function u(e){return e.displayType===n.DisplayTypes.PAPER_DOCUMENT}Object.defineProperty(t,"__esModule",{value:!0}),t.isOpenAction=i,t.isEditAction=a,t.isAddAction=s,t.isFile=c,t.isFolder=l,t.isPaperDoc=u}),define("modules/clean/react/home/recents/recent_activity_client_post_tti",["require","exports","tslib","modules/constants/python","external/lodash","modules/clean/react/home/api","modules/clean/react/home/recents/recent_activity_client_utils"],function(e,t,n,o,r,i,a){"use strict";function s(e,t,n,o){return void 0===o&&(o=!0),i.makeRequest({subject_user:e,type:"POST",url:t,data:n},{isBackground:o})}function c(e,t,o,r){return void 0===r&&(r=!0),n.__awaiter(this,void 0,void 0,function(){var i;return n.__generator(this,function(n){switch(n.label){case 0:return i=a.getPayload,[4,s(e,t,o,r)];case 1:return[2,i.apply(void 0,[n.sent()])]}})})}function l(e,t){return s(e,"/recents/json",{num_activities:t?20:10,cursor:t})}function u(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,s(e,"/home_feed/retrieve_paper_recents",{is_initial_fetch:t})];case 1:return[2,n.sent()]}})})}function d(e,t){i.makeRequest({url:"/recents/logger",type:"POST",subject_user:e,data:t,dataType:"text"},{isBackground:!0})}function _(e,t){return c(e,"/home_feed/archive_paper_resources",{resources_json:JSON.stringify(t)},!1)}function m(e,t,i){return n.__awaiter(this,void 0,void 0,function(){var a;return n.__generator(this,function(n){switch(n.label){case 0:return[4,c(e,"/activity/generate/json",{activity_keys:JSON.stringify(r.uniq(t)),loading_modes:JSON.stringify([o.FILE_ACTIVITY_LOADING_MODE.PREVIEW_INFO]),encrypted:i})];case 1:return a=n.sent(),[2,a.activities_by_activity_key]}})})}function p(e,t){return n.__awaiter(this,void 0,void 0,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,c(e,"/recents/check_files_in_root_collection",{files_json:JSON.stringify(t)})];case 1:return o=n.sent(),[2,o.file_in_root_collection_info]}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchPayload=c,t.recentsJson=l,t.retrievePaperRecents=u,t.postLogEvent=d,t.archivePaperResources=_,t.activityGenerateJson=m,t.checkFileInRootCollection=p}),define("modules/clean/react/home/recents/recent_activity_file_action_post_tti",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/react/home/store","modules/clean/react/home/recents/models/utils","modules/clean/react/home/util/file_utils","modules/clean/react/app_actions/app_actions_menu","modules/clean/react/app_actions/app_actions_store","modules/clean/react/home/resource_id_types"],function(e,t,n,o,r,i,a,s,c,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(t){var n=e.call(this,t)||this;return n.onActionDropdownOpen=function(){n.setState({isActionDropdownOpen:!0})},n.onActionDropdownClose=function(){n.setState({isActionDropdownOpen:!1})},n.state={isActionDropdownOpen:!1,actionCategories:[],appActionFile:s.getFileFromPartial({})},n}return n.__extends(t,e),t.prototype.getAppActions=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var o,r,i;return n.__generator(this,function(n){switch(n.label){case 0:return o=e&&e.idType===u.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID,o&&t.length&&e.viewingUserId&&e.displayName?(r=s.getFileFromPartial({file_id:e.resourceId,ext:a.getExtension(e.displayName),ns_id:t[0].nsId||void 0,ns_path:t[0].nsPath||void 0}),[4,l.getAppActionsStore().getActionsForFile(r,e.viewingUserId)]):[2];case 1:return i=n.sent()||[],this.setState({actionCategories:i,appActionFile:r}),[2]}})})},t.prototype.componentWillReceiveProps=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return e.recentItem===this.props.recentItem?[3,2]:[4,this.getAppActions(this.props.recentItem,this.props.attachments)];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.componentWillMount=function(){this.getAppActions(this.props.recentItem,this.props.attachments)},t.prototype.render=function(){return this.state.actionCategories&&this.state.actionCategories.length?o.createElement("div",{className:"recents-item__file-actions recents-item__action-button"},o.createElement(c.AppActionsMenu,{file:this.state.appActionFile,buttonText:r._("Open with â–¾"),actionCategories:this.state.actionCategories,user:i.getUser(),onDropdownOpen:this.onActionDropdownOpen,onDropdownClose:this.onActionDropdownClose,telemetryContext:{surface:"home_recent"}})):null},t})(o.PureComponent);t.RecentActivityFileActionPost=d}),define("modules/clean/react/home/recents/recent_activity_filter_actions_post_tti",["require","exports","tslib","external/lodash","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/stores/attachment_store","modules/clean/react/home/recents/models/utils_post_tti"],function(e,t,n,o,r,i,a){"use strict";function s(e){return r.ALL_AVAILABLE_FILTER_TYPES.filter(function(n){return e.some(function(e){return t.RECENT_ITEMS_FILTER_TYPE_TO_FUNCTION[n](e)})})}function c(e,t){var n=t.includes(r.RecentItemsFilterType.EXPAND_AGGREGATIONS);t=o.without(t,r.RecentItemsFilterType.EXPAND_AGGREGATIONS);var i=l(e,t);return n?d(i):i}function l(e,t){return 0===t.length?e:e.filter(u(t))}function u(e){return function(n){return e.some(function(e){return t.RECENT_ITEMS_FILTER_TYPE_TO_FUNCTION[e](n)})}}function d(e){var t=e.map(function(e){return _(e)?m(e):e});return o.flatten(t)}function _(e){return e.attachmentIds.length>1}function m(e){return p(e).map(function(t){return n.__assign({},e,{id:t.id,attachmentIds:[t.id],displayName:t.displayName})})}function p(e){return i.getAttachmentStore().getByIds(e.attachmentIds)}Object.defineProperty(t,"__esModule",{value:!0}),t.RECENT_ITEMS_FILTER_TYPE_TO_FUNCTION=(h={},h[r.RecentItemsFilterType.INCLUDE_OPEN_ACTIONS]=a.isOpenAction,h[r.RecentItemsFilterType.INCLUDE_EDIT_ACTIONS]=a.isEditAction,h[r.RecentItemsFilterType.INCLUDE_ADD_ACTIONS]=a.isAddAction,h[r.RecentItemsFilterType.INCLUDE_FILES]=a.isFile,h[r.RecentItemsFilterType.INCLUDE_FOLDERS]=a.isFolder,h[r.RecentItemsFilterType.INCLUDE_PAPER_DOCS]=a.isPaperDoc,h),t.getAvailableFiltersFromRecentItems=s,t.processRecentItems=c;var h}),define("modules/clean/react/home/recents/recent_activity_logger_post_tti",["require","exports","tslib","external/lodash","modules/core/exception","modules/clean/react/home/recents/recent_activity_client_post_tti"],function(e,t,n,o,r,i){"use strict";function a(e,t,o){if(void 0===o&&(o={}),v){var r=n.__assign({},o,{event_name:t});i.postLogEvent(e,r)}}function s(e,t,n){var i=Object.keys(n),a=o.difference(i,t);r.assert(0===a.length,e+" called with unsupported keys: "+a)}function c(){v=!0}function l(){v=!1}function u(e,t){s("logPageLoaded",p,t),a(e,"client_page_loaded",t)}function d(e,t){s("logRequestFailed",h,t),a(e,"request_failed",t)}function _(e,t){s("logCellAction",f,t),a(e,"cell_action",t)}function m(e,t){s("logTimeToFirstAction",g,t),a(e,"time_to_first_action",t)}Object.defineProperty(t,"__esModule",{value:!0});t.FilterViews={EVERYTHING:"everything"};var p=["is_full_page","item_count","contains_aggregation","latency","is_paginated"],h=["failure_type","is_paginated"],f=["in_aggregation","filter_view","action_type","target_activity_type","action_scope","position","file_extension","days_ago"],g=["latency","action_type","action_scope"],v=!0;t.enableLogging=c,t.disableLogging=l,t.logPageLoaded=u,t.logRequestFailed=d,t.logCellAction=_,t.logTimeToFirstAction=m}),define("modules/clean/react/home/recents/recent_activity_logger_utils_post_tti",["require","exports","tslib","external/react-dom","external/lodash","modules/clean/react/home/recents/utils/events","modules/clean/react/home/recents/recent_activity_logger_post_tti","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/stores/attachment_store","modules/clean/web_timing_logger","modules/clean/react/home/util/navigation","modules/clean/react/home/recents/recent_activity_logger_utils"],function(e,t,n,o,r,i,a,s,c,l,u,d){"use strict";function _(e){return Math.floor((Date.now()-e)/864e5)}function m(e,t,n,i,c){var l=o.findDOMNode(c);if(null!==l){var u,d=r.filter(r.uniq(r.map(n,function(e){return null!=e?e.split(".").pop().toLowerCase():void 0})),Boolean),m=i>1;u=1===i?s.ActionScope.SINGLE:n.length===i?s.ActionScope.AGGREGATION:s.ActionScope.SUBSET;var h=Array.prototype.indexOf.call(l.parentNode.childNodes,l),f=Number(l.getAttribute("data-item-type")),g=Number(l.getAttribute("data-item-date")),v={in_aggregation:m,filter_view:a.FilterViews.EVERYTHING,action_type:e,action_scope:u,target_activity_type:f,position:h,file_extension:d.join(","),days_ago:_(g)};a.logCellAction(t,v),p(t,r.pick(v,"action_scope","action_type"))}}function p(e,t){if(d.canLogFirstAction()){var o=l.start_time();o&&(d.onLogFirstAction(),a.logTimeToFirstAction(e,n.__assign({},t,{latency:Date.now()-o})))}}function h(e){return function(t,n,o,r){m(e,t,n,o,r)}}function f(e){return function(t,n,o,r){return h(e)(t,[n],o,r)}}function g(e,t){a.logRequestFailed(e,{failure_type:t?t.status:-1,is_paginated:!1})}function v(){var e=d.getRecentsLoggingData();return function(t,n){return void 0===n&&(n={}),y(t,e,n)}}function y(e,t,o){void 0===o&&(o={});var r=n.__assign({is_full_page:t.isFullPage},o,{latency:Date.now()-t.startTime});a.logPageLoaded(e,r)}function E(e,t,n){var o=r.map(c.getAttachmentStore().getByIds(t),"fqPath").filter(Boolean);return i.logEvent(e,n.cellView,o,n.totalCount)}function I(e,t,n,o){u.logAndNavigate(e,function(){return E(t,n,o)},u.NavigationMethod.NEW_TAB)}function b(e,t,n,o){u.logAndNavigate(e,function(){return E(t,n,o)},u.NavigationMethod.REDIRECT)}Object.defineProperty(t,"__esModule",{value:!0}),t.logShareFile=f(s.ActionType.SHARE),t.logPreviewFiles=h(s.ActionType.VIEW_FILE),t.logDeleteFiles=h(s.ActionType.DELETE),t.logUnityOpenFile=f(s.ActionType.UNITY_OPEN),t.logOpenPathUrl=h(s.ActionType.OPEN_DIR),t.logOpenSharedLinkUrl=h(s.ActionType.VIEW_SHARED_LINK),t.logCommentFile=f(s.ActionType.COMMENT),t.logDownloadFile=h(s.ActionType.DOWNLOAD),t.logOpenVersions=f(s.ActionType.VERSIONS),t.logRequestFailed=g,t.startRequestTimer=v,t.logRecentsLoaded=y,t.logRecentActivityAction=E,t.openTab=I,t.openUrl=b}),define("modules/clean/react/home/recents/recent_activity_starred_post_tti",["require","exports","modules/clean/react/starred/constants","modules/clean/react/starred/actions","modules/clean/react/home/recents/recent_activity_federated_model","modules/clean/react/home/store","modules/clean/react/home/recents/recent_activity_starred","modules/clean/flux/dispatcher"],function(e,t,n,o,r,i,a,s){"use strict";function c(e){e.length&&s.Dispatcher.dispatch({type:n.StarredActionTypes.SET_STATUS,starredStatuses:e.map(function(e){return new r.FederatedRecentItem(e).getStarredStatus()})})}function l(e){var t=a.getIdTypePairsByRecentActivityItems(e);t.length&&o.StarredActions.fetchStatuses(i.getRole(),t,!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.setStarredStatusOfPaperRecentItems=c,t.fetchStarredStatus=l}),define("modules/clean/react/home/recents/store_utils_post_tti",["require","exports","tslib","external/lodash","modules/core/i18n","modules/clean/react/home/recents/stores/attachment_store","modules/core/notify","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/recent_activity_client_post_tti","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/store","modules/core/exception","modules/clean/react/home/post_tti/unity_post_tti","modules/clean/react/home/recents/store_utils","modules/clean/react/home/recents/recent_activity_logger_utils_post_tti"],function(e,t,n,o,r,i,a,s,c,l,u,d,_,m,p){"use strict";function h(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,a,d,m,p=this;return n.__generator(this,function(h){switch(h.label){case 0:return s.recentActivityDispatcher.dispatch({type:l.ADD_PENDING_ACTIVITY_KEYS,activityKeys:e}),t=i.getAttachmentStore().groupIdsByEncryptedToken(e),r=u.getUserId(),a={},d=0,[4,Promise.all(o.map(t,function(e,t){return n.__awaiter(p,void 0,void 0,function(){var o,i;return n.__generator(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),o=[{},a],[4,c.activityGenerateJson(r,e,t)];case 1:return a=n.__assign.apply(void 0,o.concat([u.sent()])),[3,3];case 2:return i=u.sent(),s.recentActivityDispatcher.dispatch({type:l.REMOVE_PENDING_ACTIVITY_KEYS,activityKeys:e}),d++,[3,3];case 3:return[2]}})})}))];case 1:if(h.sent(),s.recentActivityDispatcher.dispatch({type:l.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY,rawRelatedActivitiesByKey:a,userId:r}),m=o.map(a,function(e){return{ns_id:e.ns_id,ns_path:e.ns_path}}),m.length&&(_.getUnityFeatures().then(function(e){e&&e.check_file_batch(m,r,void 0).then(function(e){s.recentActivityDispatcher.dispatch({type:l.RECEIVE_CAN_OPEN_INFO,canOpenInfo:e})})}),c.checkFileInRootCollection(r,m).then(function(e){return s.recentActivityDispatcher.dispatch({type:l.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO,fileInRootCollectionInfo:e})})),d)throw new Error(d+" activityGenerateJson failures");return[2]}})})}function f(e,t,o){return void 0===o&&(o=l.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS),n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,g(e,t,o)];case 1:return[2,n.sent().attachments]}})})}function g(e,t,o,s){return void 0===o&&(o=l.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS),void 0===s&&(s=!1),n.__awaiter(this,void 0,void 0,function(){var c,l,u;return n.__generator(this,function(n){switch(n.label){case 0:return c=i.getAttachmentStore().getByIds(e),l=c.filter(function(e){return!e.isLoaded}).map(function(e){return e.id}),l.length?i.getAttachmentStore().areSomeActivityKeysPending(l)?[4,new Promise(function(n,r){var a=i.getAttachmentStore().addListener(function(){i.getAttachmentStore().areSomeActivityKeysPending(l)||(a(),g(e,t,o,!0).then(n,r))})})]:[3,2]:[3,10];case 1:return[2,n.sent()];case 2:if(!(o>0))return[3,8];n.label=3;case 3:return n.trys.push([3,5,,6]),[4,h(l)];case 4:return n.sent(),[3,6];case 5:return u=n.sent(),[3,6];case 6:return[4,g(e,t,o-1,!0)];case 7:return[2,n.sent()];case 8:throw d.reportStack("retry attempts depleted",{severity:d.SEVERITY.NONCRITICAL,exc_extra:{attachmentIds:e,purpose:t}}),I.indexOf(t)<0&&a.Notify.error(r._("There was a problem completing this request.")),new Error("retry attempts depleted");case 9:return[3,11];case 10:return[2,{attachments:c,isRetry:s}];case 11:return[2]}})})}function v(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,{logRecentsLoaded:p.logRecentsLoaded,ensureAttachments:f,logRequestFailed:p.logRequestFailed,loadPaperRecentItems:y}]})})}function y(e){return n.__awaiter(this,void 0,void 0,function(){var t,o,r;return n.__generator(this,function(n){switch(n.label){case 0:return t=c.retrievePaperRecents(u.getUserId(),e),o=m.handleRetrievePaperRecentsPromise,r=[v],[4,t];case 1:return o.apply(void 0,r.concat([n.sent(),e])),[2]}})})}function E(e){var t=this;return m.logErrorAndRethrowAsync(v,function(){return n.__awaiter(t,void 0,void 0,function(){var t,o;return n.__generator(this,function(n){switch(n.label){case 0:return t=m.handleAndLogRecentsJsonPromise,o=[v],[4,c.recentsJson(u.getUserId(),e)];case 1:return[2,t.apply(void 0,o.concat([n.sent(),!e]))]}})})})}Object.defineProperty(t,"__esModule",{value:!0}),t.ensureAttachments=f;var I=[l.EnsureAttachmentsPurpose.LOAD_REMAINING_ATTACHMENTS,l.EnsureAttachmentsPurpose.RECENTS_JSON_CONTINUATION];t.ensureAttachmentsWithRetryStatus=g,t.loadPaperRecentItems=y,t.loadRecentItems=E}),define("modules/clean/react/home/resource/actions_post_tti",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/home/constants","modules/clean/react/home/store","modules/clean/react/home/resource/store","modules/constants/python","modules/clean/react/file_viewer/controller","modules/core/browser","modules/clean/filepath","modules/clean/react/home/api","modules/core/uri","modules/core/browser","modules/clean/previews/constants"],function(e,t,n,o,r,i,a,s,c,l,u,d,_,m){"use strict";function p(e,t){var n=new d.URI({path:"/sm/create"+l.normalize(t)});n.updateQuery("_subject_uid",e.id.toString()),n.updateQuery("redirect","0"),u.makeRequest({url:n.toString(),type:"POST",data:null,dataType:"text"}).then(function(e){return c.redirect(e)})}function h(e,t,c){var l=i.getHomeResourceStore().addListener(function(){var e=i.getHomeResourceStore().getFileToPreview();e&&(e.preview_type===m.PreviewType.CloudDoc&&e.preview_url?(t(),l(),_.redirect(e.preview_url)):window.requestAnimationFrame(function(){s.isShown()?s.updateFiles([e]):s.open([e],0,r.getHomeStore().getUser(),"react-file-viewer",{disableRouting:!0,canClose:!0,oref:a.OREF_CONSTANTS.HOME,fileViewTarget:a.FileViewTargetType.PRIVATE,fileViewOrigin:a.FileViewOriginType.HOME,fileViewAction:a.FileViewActionType.CLICK,shouldFocusCommentInput:c}),t(),l()}))});n.Dispatcher.dispatch({type:o.HomeResourceStoreActionTypes.REQUEST_PREVIEW,resourceId:e})}Object.defineProperty(t,"__esModule",{value:!0}),t.createAutoShareLink=p,t.openInFileViewer=h}),define("modules/clean/react/home/resource/api_post_tti",["require","exports","modules/clean/react/home/api"],function(e,t,n){"use strict";function o(e,t){return n.makeRequest({url:"/home_feed/get_file_metadata",type:"POST",subject_user:e.id,data:{resources_json:JSON.stringify(t)}},{isBackground:!0})}Object.defineProperty(t,"__esModule",{value:!0}),t.getFileMetadata=o}),define("modules/clean/react/home/roots/home_access_main_post_tti",["require","exports","external/lodash","modules/clean/react/home/onboarding/store_post_tti","modules/clean/user_education/user_education_client","modules/clean/react/home/onboarding/actions_post_tti","modules/clean/user_education/user_education_interface"],function(e,t,n,o,r,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initHomeOnboarding=n.once(function(e){var t=e.showUnreadOnboarding,n=e.onboardingComplete;o.getHomeOnboardingStore(),r.eventEmitter.on(a.UserEducationStateChannel,i.handleHomeUserEducationStateSteps),i.updateShowUnreadOnboarding(t),n&&i.markHomeOnboardingComplete()})}),define("modules/clean/react/home/roots/home_access_web_post_tti",["require","exports","tslib","modules/clean/history","modules/clean/upsell/prompt_event_emitter"],function(e,t,n,o,r){"use strict";function i(t,i){return n.__awaiter(this,void 0,void 0,function(){var a=this;return n.__generator(this,function(s){return o.remove_query_param("role"),t&&new Promise(function(t,n){e(["modules/clean/payments/snapengage"],t,n)}).then(function(e){return e.ajaxFetchAndLoadSnapengageParams()}),new Promise(function(t,n){e(["modules/clean/growth/experiments/overquota_helper"],t,n)}).then(function(e){e.OverquotaHelper.maybeShowSubgrowthProOQRecurringModal("wb_oq_ups_recur_hm")}),r.promptBufferedEventEmitter.on(r.Events.ON_PROMPT_INITIALIZED,function(t){return n.__awaiter(a,void 0,void 0,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:return t&&(t.didMainCampaignLoad()||t.didCampaignForUserEducationLoad())?[2]:i?[4,new Promise(function(t,n){e(["modules/clean/react/ncct/post_tti_ncct_modal"],t,n)})]:[3,2];case 1:o=n.sent().postTTINCCTReminderModal,o(),n.label=2;case 2:return[2]}})})}),[2]})})}Object.defineProperty(t,"__esModule",{value:!0}),t.homeAccessWebComponentDidMount=i}),define("modules/clean/react/home/starred/actions_post_tti",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/home/resource/api_post_tti","modules/clean/react/starred/id_type_pair","modules/clean/react/home/constants","modules/clean/react/home/store","modules/clean/react/home/starred/constants","modules/clean/react/home/starred/api_post_tti","modules/clean/react/home/starred/actions"],function(e,t,n,o,r,i,a,s,c,l,u){"use strict";function d(){return n.__awaiter(this,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:o.Dispatcher.dispatch({type:c.StarredResourceActionTypes.LOADING_ALL}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,l.retrieveStarred(c.LOAD_ALL_ITEMS_COUNT)];case 2:return e=n.sent(),[3,4];case 3:throw t=n.sent(),u.onRetrieveStarredError(c.StarredLoadingTypes.ALL,t);case 4:return u.StarredActions.handleRetrieveStarredPayload(function(){return Promise.resolve({getStarredStatusMetadata:_})},c.StarredLoadingTypes.ALL,e),[2]}})})}function _(e){return n.__awaiter(this,void 0,void 0,function(){var t,c,l;return n.__generator(this,function(n){switch(n.label){case 0:return t=e.map(function(e){return e.idTypePair}),0===t.length?[2]:[4,r.getFileMetadata(s.getUser(),t)];case 1:return c=n.sent(),l={},c.forEach(function(e){return l[i.idTypePairToString(e)]=e.file_metadata}),o.Dispatcher.dispatch({type:a.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE,resourceIdToFile:l}),[2]}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.loadAllStarredItems=d,t.getStarredStatusMetadata=_}),define("modules/clean/react/home/starred/api_post_tti",["require","exports","tslib","modules/clean/react/home/api","modules/clean/react/home/store"],function(e,t,n,o,r){"use strict";function i(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,o.makeRequest({url:"/home_feed/retrieve_starred",type:"POST",data:{role:r.getRole(),limit:e}})];case 1:return[2,t.sent()]}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveStarred=i}),define("modules/clean/react/home/starred/starred_item_file_action_post_tti",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/react/home/recents/models/utils","modules/clean/react/home/util/file_utils","modules/clean/react/app_actions/app_actions_menu","modules/clean/react/app_actions/app_actions_store","modules/clean/react/home/resource_id_types"],function(e,t,n,o,r,i,a,s,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(t){var n=e.call(this,t)||this;return n.onActionDropdownOpen=function(){n.setState({isActionDropdownOpen:!0})},n.onActionDropdownClose=function(){n.setState({isActionDropdownOpen:!1})},n.state={isActionDropdownOpen:!1,actionCategories:[],appActionFile:a.getFileFromPartial({})},n}return n.__extends(t,e),t.prototype.getAppActions=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var o,r;return n.__generator(this,function(n){switch(n.label){case 0:return e.idType===l.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID&&t.id&&e.title?(o=a.getFileFromPartial({file_id:e.resourceId,ext:i.getExtension(e.title)}),[4,c.getAppActionsStore().getActionsForFile(o,t.id)]):[2];case 1:return r=n.sent()||[],this.setState({actionCategories:r,appActionFile:o}),[2]}})})},t.prototype.componentWillReceiveProps=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:
return e.starredItem===this.props.starredItem?[3,2]:[4,this.getAppActions(this.props.starredItem,this.props.user)];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.componentWillMount=function(){this.getAppActions(this.props.starredItem,this.props.user)},t.prototype.render=function(){return this.state.actionCategories&&this.state.actionCategories.length?o.createElement("div",{className:"starred-item__file-actions"},o.createElement(s.AppActionsMenu,{file:this.state.appActionFile,buttonText:r._("Open with â–¾"),actionCategories:this.state.actionCategories,user:this.props.user,onDropdownOpen:this.onActionDropdownOpen,onDropdownClose:this.onActionDropdownClose,telemetryContext:{surface:"home_starred"}})):null},t})(o.PureComponent);t.StarredItemFileActionPost=u}),define("modules/clean/react/home/unread/card_post_tti",["require","exports","modules/clean/react/user_notifications/actions"],function(e,t,n){"use strict";function o(e){n.acknowledge(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.acknowledgeNotification=o}),define("modules/clean/react/home/unread/home_access_unread_post_tti",["require","exports","modules/clean/react/home/onboarding/actions_post_tti"],function(e,t,n){"use strict";function o(){setTimeout(n.showUnreadOnboardingTooltipIfNecessary)}Object.defineProperty(t,"__esModule",{value:!0}),t.triggerUnreadOnboarding=o}),define("modules/clean/react/home/unread/store_post_tti",["require","exports","modules/clean/react/user_notifications/actions","modules/clean/react/user_notifications/store"],function(e,t,n,o){"use strict";function r(){return n.loadOnceAndWatch(!0),o.userNotificationsStore}Object.defineProperty(t,"__esModule",{value:!0}),t.listenToAndGetNotificationStore=r}),define("modules/clean/react/home/unread/tasks_post_tti",["require","exports","external/react","modules/core/i18n"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tasks=function(e){return e.tasks.forMe.length,n.createElement("div",{className:"home-access__empty-text"},o._("You have no to-dos!"))}}),define("modules/clean/react/home/util/constants_post_tti",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HOME_V1_USER_EDUCATION_STEP_NAMES={START:"start",RECENTLY_VIEWED:"recently_viewed",FILES:"files",PAPER:"paper"},t.DEFAULT_ONBOARDING_POST_TTI_PROPS={showUnreadOnboarding:!1,onboardingComplete:!0}}),define("modules/clean/react/home/util/file_utils",["require","exports","tslib","modules/clean/react/browse/models"],function(e,t,n,o){"use strict";function r(e){return new o.File(e?n.__assign({},i,e):i)}Object.defineProperty(t,"__esModule",{value:!0});var i={beacon_context:"",bytes:1024,direct_blockserver_link:"",event_type:0,ext:"",file_id:"",fq_path:"",href:"",icon:"",is_cloud_doc:!1,is_dir:!1,is_in_team_folder_tree:!1,is_symlink:!1,is_unmounted:!1,mount_access_perms:[],ns_id:0,ns_path:"",revision_id:"",sjid:0,sort_key:[""],target_ns:null,type:1};t.getFileFromPartial=r}),define("modules/clean/react/home/util/logging/availability_logger_post_tti",["require","exports","tslib","external/lodash","modules/clean/react/home/constants","modules/clean/react/home/api","modules/clean/react/home/store","modules/clean/react/home/util/logging/availability_logger_common"],function(e,t,n,o,r,i,a,s){"use strict";function c(e){var t=e.sectionToTTI,c=e.sectionToIsSkipped,l=e.sectionToTTData,u=e.typeToExecutionData,d={};Object.keys(r.HomeSections).forEach(function(e){var n=r.HomeSections[e];d[n]={tti:t[n],tt_data:l[n],skipped:c[n]}});var _=a.getHomeStore(),m=_.getUser();i.makeRequest({url:"/log/home_availability",type:"POST",dataType:"text",subject_user:m.id,data:{success:o.values(u).every(function(e){return e.success||!s.isPendingPrefetch(_,e)}),metrics_json:JSON.stringify({referrer:document.referrer}),sections_json:JSON.stringify(d),prefetches_json:JSON.stringify(o.mapValues(u,function(e,t){var o=e.success,r=e.homeTiming,i=s.HOME_PREFETCH_TYPE_TO_INFO[t].section;return n.__assign({},r,{conditional_loading_preference:_.getSectionLoadingPreference(i),conditional_loading_mode:_.getSectionLoadingMode(i),success:!!o})}))}},{isBackground:!0,delayRequest:!0,shouldAssertResponse:!0})}Object.defineProperty(t,"__esModule",{value:!0}),t.logHomeAvailability=c}),define("modules/clean/react/home/util/logging/unread_logger_post_tti",["require","exports","modules/clean/loggers/notification_logger"],function(e,t,n){"use strict";function o(e){n.NotificationLogger.logAction(e,"surface",n.NotificationLocations.HOME_PAGE)}function r(e){n.NotificationLogger.logMarkAsRead([e],n.NotificationLocations.HOME_PAGE)}function i(e){n.NotificationLogger.logRender(e,-1,n.NotificationLocations.HOME_PAGE)}Object.defineProperty(t,"__esModule",{value:!0}),t.logOpenUnreadNotificationItem=o,t.logMarkNotificationAsRead=r,t.logRenderedNotifications=i}),define("modules/clean/react/home/util/static_tooltip_post_tti",["require","exports","external/react","external/react-dom","modules/clean/react/bubble_dropdown_v2","modules/clean/react/sprite","modules/core/i18n"],function(e,t,n,o,r,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(){var e=this;this.isTooltipTriggered=!1,this.onTooltipTriggerRendered=function(t){e.isTooltipTriggered||(e.isTooltipTriggered=!0,e.triggerButton=t,e.simulateTriggerButtonClick())},this.simulateTriggerButtonClick=function(){e.triggerButton.click()},this.show=function(t,s,c,l,u,d,_){void 0===_&&(_="");var m=n.createElement("button",{className:"home-tooltip__trigger-button",ref:e.onTooltipTriggerRendered,"aria-label":"close"}),p=n.createElement(r.BubbleDropdown,{className:"home-tooltip",position:l,targetButton:m,onShowDropdown:u||function(){},onHideDropdown:d||function(){}},n.createElement("h4",{className:"home-tooltip__title"},t),s,n.createElement("button",{className:"home-tooltip__close-button",onClick:e.simulateTriggerButtonClick,"aria-label":a._("Close tooltip")},n.createElement(i.Sprite,{group:"web",name:"lightbox_close",alt:a._("Close")}))),h=e.createMountingElement(_);c.appendChild(h),o.render(p,h)},this.hide=function(){e.simulateTriggerButtonClick()}}return e.prototype.createMountingElement=function(e){var t=document.createElement("DIV");return e&&(t.className=e),t.addEventListener("click",function(e){e.preventDefault()}),t},e.POSITIONS=r.BubbleDropdown.POSITIONS,e})();t.StaticTooltip=s}),define("modules/clean/react/radio",["require","exports","tslib","external/classnames","external/react","external/react-dom","external/prop-types"],function(e,t,n,o,r,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RadioItemVariant={Normal:"normal",Large:"large"};var s=Object.keys(t.RadioItemVariant).map(function(e){return t.RadioItemVariant[e]}),c=a.oneOfType([a.string,a.number,a.bool]),l=(function(e){function l(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleClick=function(){t._isSelected()||(i.findDOMNode(t.refs.input).focus(),"function"==typeof t.props._radioGroupData.onSelect&&t.props._radioGroupData.onSelect(t.props.value))},t._handleChange=function(){"function"==typeof t.props._radioGroupData.onSelect&&t.props._radioGroupData.onSelect(t.props.value)},t._getId=function(){return t.props._radioGroupData.name+"_"+t.props.value},t._isSelected=function(){return t.props._radioGroupData.radioGroupValue===t.props.value},t}return n.__extends(l,e),l.prototype.render=function(){var e=this.props._radioGroupData,n=["c-radio-wrapper",this.props.className],i={"c-radio":!0,"c-radio--selected":this._isSelected()};return Array.from(s).includes(e.variant)&&e.variant!==t.RadioItemVariant.Normal&&(i["c-radio--"+e.variant]=!0),r.createElement("div",{className:o(n),onClick:this._handleClick},r.createElement("input",{id:this._getId(),ref:"input",type:"radio",name:e.name,value:this.props.value,checked:this._isSelected(),onChange:this._handleChange}),r.createElement("div",{className:o(i)},r.createElement("div",{className:"c-radio__inner"})),r.createElement("label",{className:"c-radio-content",htmlFor:this._getId()},this.props.children))},l.displayName="RadioItem",l.propTypes={className:a.string,value:c,_radioGroupData:a.shape({variant:a.oneOf(s),name:a.string.isRequired,radioGroupValue:c,onSelect:a.func})},l})(r.Component);t.RadioItem=l;var u=(function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRadioItemSelect=function(e){null!=t.props.valueLink&&t.props.valueLink.requestChange(e)},t}return n.__extends(i,e),i.prototype.render=function(){var e=this,t=this.props.name||"radio-"+Math.floor(1e9*Math.random()),n=r.Children.map(this.props.children,function(n){return"RadioItem"===n.type.displayName?r.cloneElement(n,{_radioGroupData:{variant:e.props.variant,name:t,radioGroupValue:e.props.valueLink.value,onSelect:e._onRadioItemSelect}}):n}),i={"c-radio-group__legend":!0,"ax-visually-hidden":!this.props.displayLegend},a=["c-radio-group","align-"+this.props.align,this.props.className];return r.createElement("fieldset",{className:o(a)},r.createElement("legend",{className:o(i)},this.props.legend),n)},i.displayName="RadioGroup",i.propTypes={className:a.string,variant:a.oneOf(s),name:a.string,legend:a.string.isRequired,align:a.oneOf(["top","bottom","middle","baseline"]),displayLegend:a.bool,valueLink:a.object},i.defaultProps={className:null,type:t.RadioItemVariant.Normal,align:"middle",displayLegend:!1},i})(r.Component);t.RadioGroup=u}),define("modules/clean/sharing/wizard/share_a_folder_wizard_modal",["require","exports","tslib","external/react","external/react-dom-factories","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/radio","modules/clean/viewer","modules/core/i18n","modules/clean/react/input"],function(e,t,n,o,r,i,a,s,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o.createElement,d=l.i18n_default_project("sharing")._,_=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={option:"new-folder"},t._renderContent=function(){return r.form({className:"shared-folder-wizard__contents",onSubmit:function(e){return"function"==typeof e.nativeEvent.preventDefault&&e.nativeEvent.preventDefault(),t.props.onSubmit(t.state.option)}},t._renderHeader(),t._renderRadio(),t._renderButtons())},t._renderHeader=function(){return r.div({className:"shared-folder-wizard__header u-mar-bottom-s"},d("What would you like to do?"))},t._renderRadio=function(){var e={value:t.state.option,requestChange:t._handleChange};return r.div({className:"radio-input"},u(s.RadioGroup,{variant:s.RadioItemVariant.Normal,legend:d("Share a Folder options"),displayLegend:!1,valueLink:e},t._renderRadioItems()))},t._renderRadioItems=function(){return[u(s.RadioItem,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},r.div({className:"new-folder_title u-l-ib u-pad-left-xs"},d("Iâ€™d like to create and share a new folder"))),u(s.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},r.div({className:"existing-folder_title u-l-ib u-pad-left-xs"},d("Iâ€™d like to share an existing folder")))]},t._handleChange=function(e){return t.setState({option:e})},t._renderButtons=function(){return r.div({className:"u-mar-top-m clearfix"},r.div({className:"u-l-fr"},r.button({className:"c-btn c-btn--primary",onClick:function(e){return"function"==typeof e.nativeEvent.preventDefault&&e.nativeEvent.preventDefault(),t.props.onSubmit(t.state.option)}},d("Next"))))},t}return n.__extends(t,e),t.prototype.render=function(){var e=this;return u(a.Modal,{autoClose:!1,className:"shared-folder-wizard",buttonComponent:r.span(),title:(function(){switch(e.props.user.role){case"work":return d("Share a folder from your %(team_name)s Dropbox").format({team_name:c.Viewer.get_viewer().team_name});case"personal":return d("Share a folder from your personal Dropbox")}})()},this._renderContent())},t.displayName="ShareAFolderWizardModalNoCss",t})(o.Component);t.ShareAFolderWizardModal=i(_,["/static/css/sharing/wizard_modals-vfla1DTmf.css","/static/css/modal-vflI292PU.css"])}),define("modules/clean/sharing/wizard/share_existing_folder_wizard_modal",["require","exports","tslib","external/react","external/react-dom-factories","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/tree_view","modules/clean/viewer","modules/core/i18n","modules/clean/react/input"],function(e,t,n,o,r,i,a,s,c,l){"use strict";function u(e,t){return void 0!==e&&null!==e?t(e):void 0}Object.defineProperty(t,"__esModule",{value:!0});var d=o.createElement,_=l.i18n_default_project("sharing")._,m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t._renderContent=function(){return r.form({className:"existing-shared-folder-wizard__contents",onSubmit:function(){return t.props.onSubmit(t.state.folderPath,t._setError)}},t._renderError(),t._renderTreeView(),t._renderButtons())},t._renderError=function(){if(null!=t.state.folderPath&&(null!=t.state.errorMsg?t.state.errorMsg.length:void 0)>0)return r.div({className:"text-input-error-wrapper"},r.div({className:"text-input-error-text u-font-danger"},t.state.errorMsg))},t._renderTreeView=function(){return o.createElement(s.UserFolderTreeView,{user:t.props.user,is_paired:!1,onFolderSelected:t._setFolderPath,treeRootName:c.Viewer.get_role_title(t.props.user)||_("Dropbox")})},t._renderButtons=function(){return r.div({className:"u-mar-top-m clearfix"},r.div({className:"u-l-fr"},r.button({className:"c-btn c-btn--primary",disabled:!t._isValid(),onClick:function(e){return"function"==typeof e.nativeEvent.preventDefault&&e.nativeEvent.preventDefault(),t.props.onSubmit(t.state.folderPath,t._setError)}},_("Next"))),r.div({className:"u-l-fl"},r.button({className:"button-as-link",style:{lineHeight:"32px"},onClick:function(e){return"function"==typeof e.nativeEvent.preventDefault&&e.nativeEvent.preventDefault(),a.Modal.close(),"function"==typeof t.props.onBack?t.props.onBack():void 0}},_("Back"))))},t._setFolderPath=function(e){return t.setState({folderPath:e,errorMsg:void 0})},t._setError=function(e){return t.setState({errorMsg:u(null!=e?e.path:void 0,function(e){return e.message_text})})},t._isValid=function(){return null!=t.state.folderPath&&null==t.state.errorMsg},t}return n.__extends(t,e),t.prototype.render=function(){var e=this;return d(a.Modal,{autoClose:!1,className:"existing-shared-folder-wizard",buttonComponent:r.span(),onDismissCompleted:function(){return a.Modal.close()},title:(function(){switch(e.props.user.role){case"work":return _("Choose a folder from your %(team_name)s Dropbox").format({team_name:c.Viewer.get_viewer().team_name});case"personal":return _("Choose a folder from your personal Dropbox")}})()},this._renderContent())},t.displayName="ShareExistingFolderWizardModalNoCss",t})(o.Component);t.ShareExistingFolderWizardModal=i(m,["/static/css/sharing/wizard_modals-vfla1DTmf.css"])}),define("modules/clean/sharing/wizard/wizard_modals",["require","exports","external/react","modules/clean/css","modules/clean/account/email","modules/clean/account/email_verify_reasons","modules/clean/analytics","modules/clean/legacy_pyxl_controllers/ajax_form","modules/clean/react/modal","modules/clean/sharing/api","modules/clean/sharing/share_modal_util","modules/clean/sharing/ui_notifications_util","modules/clean/sharing/wizard/share_a_folder_wizard_modal","modules/clean/sharing/wizard/share_existing_folder_wizard_modal","modules/constants/sharing","modules/clean/sharing/async_share_modal_util"],function(e,t,n,o,r,i,a,s,c,l,u,d,_,m,p,h){"use strict";function f(e){if(r.EmailVerification.get_for_user(e).verified_or_show(i.SHARE_FOLDER)){o.require_css("/static/css/scooter/scooter-scoped-vflrM1SRf.css");var t=u.generateModalSessionId();return a.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_A_FOLDER_WIZARD",{modalSessionId:t}),e.is_cdm_member?h.asyncShowNewFolderShareModal(e,t,e.cdm_tmf_path):g(e,t),t}}function g(e,t){var o=function(n){return null!=t&&a.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_A_FOLDER_WIZARD",{target:n,modalSessionId:t}),"new-folder"===n?h.asyncShowNewFolderShareModal(e,t,e.cdm_tmf_path):"existing-folder"===n?y(e,function(){return f(e)},t):void 0};c.Modal.showInstance(n.createElement(_.ShareAFolderWizardModal,{user:e,onSubmit:o}))}Object.defineProperty(t,"__esModule",{value:!0});var v=function(e,t,n,o){var r=function(){return h.asyncShowShareModal(e,{fqPath:t,isFolder:!0,exists:!0,origin:"WIZARD",modalSessionId:null!=o?o:void 0})},i=function(e){var t=s.extract_errors(e.responseText);return t===!1?void 0:"string"==typeof t?d.sharingNotificationError(t):"function"==typeof n?n(t):void 0};return p.TRUELINK.TRUELINK_UI[e.id]?r():(new l.SharingApi(e).validate_shareable_existing_sf_path(t,r,i),Promise.resolve(!0))};t.shareExistingFolder=v;var y=function(e,t,o){return null!=o&&a.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:o}),c.Modal.showInstance(n.createElement(m.ShareExistingFolderWizardModal,{user:e,onBack:t,onSubmit:function(t,n){var r=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return null!=o&&a.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD_ERROR",{modalSessionId:o}),n.apply(void 0,Array.from(t||[]))};return null!=o&&a.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:o}),v(e,t,r)}}))};t.showShareAFolderWizardModal=f});
//# sourceMappingURL=pkg-home-post-tti.min.js-vfl2FwVTF.map