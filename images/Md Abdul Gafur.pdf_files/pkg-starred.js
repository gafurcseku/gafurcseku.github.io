define("modules/clean/react/home/recents/recent_activity_starred",["require","exports","external/lodash","modules/clean/react/starred/id_type_pair"],function(e,t,r,a){"use strict";function o(e){return e.resource_id&&e.id_type?{id:e.resource_id,type:e.id_type}:null}function s(e){var t={};return e.forEach(function(e){var r=o(e);r&&(t[a.idTypePairToString(r)]=r)}),r.values(t)}function n(e){return e.resourceId&&e.idType?{id:e.resourceId,type:e.idType}:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getIdTypePair=o,t.getIdTypePairsByRecentActivityItems=s,t.getIdTypePairFromRecentItem=n}),define("modules/clean/react/home/starred/actions",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/home/starred/constants","modules/clean/react/home/starred/models/starred_item","modules/clean/react/starred/model","modules/core/exception"],function(e,t,r,a,o,s,n){"use strict";function i(e,t){return r.Dispatcher.dispatch({type:a.StarredResourceActionTypes.LOAD_FAILURE,error:t,loadingType:e}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.onRetrieveStarredError=i;var c=(function(){function e(){}return e.handleRetrieveStarredPayload=function(e,t,c){if("success"!==c.status)throw i(t,c.status);if(!c.items||void 0===c.has_more)throw n.reportStack("Home starred items request returned success without items or hasMore",{severity:n.SEVERITY.NONCRITICAL}),i(t,new Error("Invalid server response for Starred getItems"));var d=c.items.map(o.starredItemFromJson),l=s.statusResultsToStarredStatuses(d.map(o.starredItemModelToStarredStatus));r.Dispatcher.dispatch({type:a.StarredResourceActionTypes.LOAD_SUCCESS,hasMore:c.has_more,items:d,starredStatuses:l,loadingType:t}),e().then(function(e){return(0,e.getStarredStatusMetadata)(l)})},e})();t.StarredActions=c}),define("modules/clean/react/home/starred/conditional_interface",["require","exports","modules/clean/react/home/starred/starred_resource_store","modules/clean/react/starred/star","modules/clean/react/home/recents/recent_activity_starred","modules/clean/react/home/starred/starred_view","modules/clean/react/starred/id_type_pair"],function(e,t,r,a,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStarredResourceStore=r.getStarredResourceStore,t.Star=a.Star,t.getIdTypePairFromRecentItem=o.getIdTypePairFromRecentItem,t.StarredView=s.StarredView,t.idTypePairToString=n.idTypePairToString}),define("modules/clean/react/home/starred/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredResourceActionTypes={LOADING_INITIAL:"HOME_STARRED_LOADING_INITIAL",LOADING_ALL:"HOME_STARRED_LOADING_ALL",LOAD_SUCCESS:"HOME_STARRED_LOAD_SUCCESS",LOAD_FAILURE:"HOME_STARRED_LOAD_FAILURE",HIDE_EMPTY_SECTION:"HOME_STARRED_HIDE_EMPTY_SECTION"},t.NOT_PAPER_USER_ERROR="not_paper_user",t.StarredLoggingTypes={CLICK_STAR:"click_star",CLICK_UNSTAR:"click_unstar"},t.StarredLoadingTypes={INITIAL:"INITIAL",ALL:"ALL"},t.LOAD_ALL_ITEMS_COUNT=1e3}),define("modules/clean/react/home/starred/models/starred_item",["require","exports","modules/clean/react/home/constants"],function(e,t,r){"use strict";function a(e){return{title:e.title,resourceId:e.resource_id,idType:e.id_type,displayType:e.display_type,url:e.url,details:o(e.display_type,e.details)}}function o(e,t){var a=r.DisplayTypeToResourceType[e];if(a===r.FILE_RESOURCE_TYPE){var o=t;return{fqPath:o.fq_path}}if(a===r.FOLDER_RESOURCE_TYPE){var o=t;return{fqPath:o.fq_path,targetNsId:o.target_ns_id,isTeamMemberFolder:o.is_team_member_folder}}if(a===r.EXTERNAL_RESOURCE_TYPE){var o=t;return{favicon:o.favicon}}return{}}function s(e){return{id:e.resourceId,type:e.idType,is_starred:!0}}Object.defineProperty(t,"__esModule",{value:!0}),t.starredItemFromJson=a,t.detailsFromJson=o,t.starredItemModelToStarredStatus=s}),define("modules/clean/react/home/starred/starred_helper_components",["require","exports","external/react","spectrum/tabbed_header","modules/core/i18n"],function(e,t,r,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s;(function(e){e.STARRED="Starred",e.TODO="To-do"})(s=t.StarredTab||(t.StarredTab={})),t.STARRED_TAB_TITLE=o._("Starred"),t.TODO_TAB_TITLE=o._("To-do"),t.StarredTabbedHeader=function(e){var o=e.onSelection,n=e.activeTabId;return r.createElement("div",{className:"home__tab-header"},r.createElement(a.TabbedHeader,{onSelection:o,activeTabId:n},r.createElement(a.Tab,{active:n===s.STARRED,id:s.STARRED},t.STARRED_TAB_TITLE),r.createElement(a.Tab,{active:n===s.TODO,id:s.TODO},t.TODO_TAB_TITLE)))},t.StarredFrame=function(e){var t=e.children;return r.createElement("li",{className:"home-access-section"},r.createElement("div",{className:"starred"},t))}}),define("modules/clean/react/home/starred/starred_item",["require","exports","tslib","external/classnames","spectrum/overflow_button","spectrum/popover","external/react","modules/core/i18n","modules/clean/react/home/store","modules/clean/react/home/util/navigation","modules/clean/react/home/util/resource_icon","modules/clean/react/starred/actions","modules/clean/react/starred/star","modules/clean/react/starred/constants","modules/clean/react/starred/id_type_pair","modules/clean/react/home/util/logging/activity_logger","modules/clean/react/home/constants","modules/clean/undo","modules/clean/user_education/react/user_education_effect","modules/clean/static_urls","modules/clean/react/home/post_tti/api","modules/clean/em_string","modules/clean/react/home/util/post_tti_components"],function(e,t,r,a,o,s,n,i,c,d,l,u,p,m,S,h,_,g,T,y,f,E,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I=(R={},R[_.FILE_RESOURCE_TYPE]=!0,R[_.FOLDER_RESOURCE_TYPE]=!0,R[_.PAPER_DOCUMENT_RESOURCE_TYPE]=!0,R),L=(function(e){function t(t){var r=e.call(this,t)||this;return r.getLoggingInfo=function(){var e=_.DisplayTypeToResourceType[r.props.item.displayType];return{resourceId:r.props.item.resourceId,resourceType:e,position:r.props.position}},r.onClick=function(e){if(!r.state.isRenaming){e.stopPropagation(),e.preventDefault();if(_.DisplayTypeToResourceType[r.props.item.displayType]!==_.FILE_RESOURCE_TYPE||d.isMetaKeyPressed(e)){var t=r.props.item.displayType===_.EXTERNAL_RESOURCE_TYPE?d.NavigationMethod.UNSAFE_NEW_TAB:d.NavigationMethod.NEW_TAB;d.logAndNavigate(r.props.item.url,r.logOpen,t)}else e.preventDefault(),f.waitForHomeTTI().then(function(e){return e.openInFileViewer(S.idTypePairToString({type:r.props.item.idType,id:r.props.item.resourceId}),r.logOpen)})}},r.onStarClick=function(e){if(!e){var t=r.getLoggingInfo(),a=t.resourceId,o=t.resourceType,s=t.position,n=r.props.item,d=i._("Removed from Starred."),l=function(e){var t=e.itemToStar,n=_.DisplayTypeToResourceType[r.props.item.displayType],i=n===_.EXTERNAL_RESOURCE_TYPE;u.StarredActions.update(c.getHomeStore().getRole(),t.resourceId,t.idType,!0,i?t.title:void 0,i?t.details.favicon:void 0),h.homeActivityLogger.logUndoUnstarItem(a,o,s)};g.notifyWithUndo(d,{itemToStar:n},l,10)}},r.logEvent=function(e){var t=r.getLoggingInfo();return e(t.resourceId,t.resourceType,t.position)},r.logOpen=function(){return r.logEvent(h.homeActivityLogger.logOpenStarredItem)},r.logClickMenu=function(){return r.logEvent(h.homeActivityLogger.logClickStarOverflowMenu)},r.logClickShare=function(){return r.logEvent(h.homeActivityLogger.logClickStarOverflowShare)},r.handleShare=function(e){return function(t){if(t.preventDefault(),r.props.item.displayType===_.PAPER_DOCUMENT_RESOURCE_TYPE)return void d.logAndNavigate(r.props.item.url+"?openSharing=1",r.logClickShare);r.logClickShare();var a=_.DisplayTypeToResourceType[r.props.item.displayType]===_.FOLDER_RESOURCE_TYPE,o=a?r.props.item.details.targetNsId:null,s=r.props.item.details.fqPath;f.waitForHomeTTI().then(function(t){e?t.createAutoShareLink(r.props.user,s):t.asyncShowShareModal(r.props.user,{fqPath:s,isFolder:a,targetNsId:o})})}},r.handleRenameInputChange=function(e){r.setState({newName:e.target.value})},r.handleRenameStart=function(e){r.setState({isRenaming:!0,newName:r.props.item.title})},r.handleRenameSubmit=function(e){e.preventDefault();var t=r.props.item,a=t.title,o=r.state.newName;void 0!==o&&null!==o&&(r.setState({isRenaming:!1,newName:""}),u.StarredActions.renameExternalResource(t.resourceId,a,o))},r.handleFaviconError=function(e){e.currentTarget.src=y.static_url("/static/images/home/generic-website-favicon-vfl8fV8SM.png")},r.stopEvent=function(e){e.stopPropagation(),e.preventDefault()},r.handleSelection=function(e,t){e(t)},r.getTitle=function(){var e=r.props.item.title,t=i._("Untitled");return E.Emstring.em_snippet(e.trim().length?e:t,30)},r.getIcon=function(){if(_.DisplayTypeToResourceType[r.props.item.displayType]===_.EXTERNAL_RESOURCE_TYPE){var e=r.props.item.details.favicon;return(void 0===e||null===e||e.startsWith("http:"))&&(e=y.static_url("/static/images/home/generic-website-favicon-vfl8fV8SM.png")),n.createElement("img",{key:"icon",src:e,alt:i._("starred webpage favicon"),onError:r.handleFaviconError,className:"starred-item__external-favicon"})}return n.createElement(l.HomeResourceIcon,{key:"icon",className:"starred-item__file-icon",displayType:r.props.item.displayType,fileName:r.props.item.title})},r.renderInnerWrapper=function(e){var t=e.children;return[r.getIcon(),n.createElement("div",{className:"starred-item__content",key:"userEducation"},n.createElement(T.UserEducationEffect,{containerName:"StarredItem",name:"starred-item-"+String(r.props.position)}),t,n.createElement("div",{className:"starred-item__star",key:"star"},n.createElement(p.Star,{user:c.getHomeStore().getUser(),id:r.props.item.resourceId,idType:r.props.item.idType,itemName:r.props.item.title,onStarClick:r.onStarClick,source:m.StarredSource.HOME_STARRED}))),n.createElement("div",{className:"starred-item__actions"},n.createElement("div",{className:"starred-item__actions-inner"},n.createElement(v.PostTTIStarredItemFileActions,{starredItem:r.props.item,user:r.props.user}),r.renderDropdown()))]},r.state={isRenaming:!1,newName:r.props.item.title},r}return r.__extends(t,e),t.prototype.renderDropdown=function(){var e=[],t=_.DisplayTypeToResourceType[this.props.item.displayType],c=this.props.item.details.isTeamMemberFolder;t in I&&!c&&(e.push(n.createElement(s.PopoverContentItem,{className:"starred-item__context-menu-item starred-item__context-menu-item--share",key:"share",value:this.handleShare()},i._("Share"))),e.push(n.createElement(s.PopoverContentItem,{className:"starred-item__context-menu-item starred-item__context-menu-item--share-link",key:"share-link",value:this.handleShare(!0)},i._("Share link")))),t===_.EXTERNAL_RESOURCE_TYPE&&e.push(n.createElement(s.PopoverContentItem,{className:"starred-item__context-menu-item",key:"rename",value:this.handleRenameStart},i._("Rename")));var d={"aria-label":i._("More actions"),onDoubleClick:function(e){e.stopPropagation()}},l=n.createElement(o.OverflowButton,r.__assign({tagName:"span",className:"starred-item__context-menu-button","aria-label":i._("More Actions")},d));return n.createElement("div",{key:"dropDown",onClick:this.stopEvent,className:a("starred-item__more-actions",{"starred-item__context-menu-emtpy":!e.length})},n.createElement(s.Popover,{onSelection:this.handleSelection,onMenuToggle:this.logClickMenu},n.createElement(s.PopoverTrigger,{className:"starred-item__context-menu-trigger"},l),n.createElement(s.PopoverContent,{attachment:"right"},e)))},t.prototype.getStarredItemName=function(){return this.state.isRenaming?n.createElement("form",{key:"name",className:"starred-item__rename-form",onSubmit:this.handleRenameSubmit},n.createElement("input",{className:"rename-input",type:"text",value:this.state.newName,onChange:this.handleRenameInputChange}),n.createElement("input",{type:"submit",value:"OK"})):n.createElement("a",{key:"name",onClick:this.onClick,href:this.props.item.url,className:"starred-item__title"},this.getTitle())},t.prototype.render=function(){var e={"starred-item":!0,"starred-item--last-in-row":this.props.lastInRow,"starred-item--in-last-row":this.props.inLastRow};return n.createElement("li",{onClick:this.onClick},n.createElement(v.PrototypePostTTICalendarStarredDragHandler,{className:a(e),innerWrapper:this.renderInnerWrapper,item:this.props.item},this.getStarredItemName()))},t.displayName="StarredItem",t})(n.PureComponent);t.StarredItem=L;var R}),define("modules/clean/react/home/starred/starred_resource_store",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/home/constants","modules/clean/react/home/starred/constants","modules/clean/react/starred/constants","modules/clean/react/home/starred/actions","modules/clean/react/starred/store","modules/clean/react/home/util/logging/availability_logger","modules/clean/flux/flux_store","modules/clean/react/home/post_tti/api"],function(e,t,r,a,o,s,n,i,c,d,l,u){"use strict";function p(){return null===S&&(S=new m),S}Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){function t(){var t=e.call(this,a.Dispatcher)||this;return t.orderedIds=[],t.itemsById={},t.loadingState=o.LoadingStates.LOADING,t.hasMore=!0,t.hasLoadedInitial=!1,t.hasLoadedAll=!1,t.isPaperUser=!0,d.getHomeAvailabilityLogger().handlePrefetch(o.HomePrefetchTypes.RETRIEVE_STARRED,function(e){return i.StarredActions.handleRetrieveStarredPayload(u.waitForHomeTTI,s.StarredResourceActionTypes.LOADING_INITIAL,e)}),t}return r.__extends(t,e),t.prototype.getStarredStore=function(){return c.StarredStore},t.prototype.clearPresentableItemsCache=function(){this.presentableItemsCache=null},t.prototype.getItems=function(){var e=this;return this.presentableItemsCache||(this.presentableItemsCache=this.orderedIds.map(function(t){return e.itemsById[t]}).filter(function(t){var r={id:t.resourceId,type:t.idType},a=e.getStarredStore().getLoadingState(r),o=e.getStarredStore().getIsStarred(r);return a===n.StarredLoadingState.LOADING||o})),this.presentableItemsCache},t.prototype.getItem=function(e){return this.itemsById[e]},t.prototype.getLoadingState=function(){return this.loadingState},t.prototype.getHasMore=function(){return this.hasMore},t.prototype.getHasLoadedInitial=function(){return this.hasLoadedInitial},t.prototype.getHasLoadedAll=function(){return this.hasLoadedAll},t.prototype.getIsPaperUser=function(){return this.isPaperUser},t.prototype.onItemsLoading=function(){this.loadingState=o.LoadingStates.LOADING},t.prototype.onItemsLoadSuccess=function(e,t){var r=this;e.forEach(function(e){r.itemsById[e.resourceId]=e}),this.loadingState=o.LoadingStates.SUCCESS,this.orderedIds=e.map(function(e){return e.resourceId}),this.hasMore=t,e.length&&this.clearPresentableItemsCache()},t.prototype.onItemsLoadFailure=function(e){this.loadingState=o.LoadingStates.FAILURE,e&&e===s.NOT_PAPER_USER_ERROR&&(this.isPaperUser=!1)},t.prototype.onItemsLoadComplete=function(e,t){e!==s.StarredLoadingTypes.INITIAL&&t||(this.hasLoadedInitial=!0),e!==s.StarredLoadingTypes.ALL&&t||(this.hasLoadedAll=!0)},t.prototype.onStatusChange=function(){u.waitForHomeTTI().then(function(e){return(0,e.loadAllStarredItems)()}),this.clearPresentableItemsCache()},t.prototype.onRenameExternalResource=function(e,t){var a=this.getItem(e),o=r.__assign({},a,{title:t});this.itemsById[e]=o},t.prototype.__onDispatch=function(e){var t=e.action;switch(t.type){case s.StarredResourceActionTypes.LOADING_INITIAL:case s.StarredResourceActionTypes.LOADING_ALL:this.onItemsLoading(),this.__emitChange();break;case s.StarredResourceActionTypes.LOAD_SUCCESS:this.onItemsLoadSuccess(t.items,t.hasMore),this.onItemsLoadComplete(t.loadingType,t.hasMore),this.__emitChange();break;case s.StarredResourceActionTypes.LOAD_FAILURE:this.onItemsLoadFailure(t.error),this.onItemsLoadComplete(t.loadingType,!0),this.__emitChange();break;case n.StarredActionTypes.LOADING:this.clearPresentableItemsCache(),this.__emitChange();break;case n.StarredActionTypes.SET_STATUS:this.onStatusChange(),this.__emitChange();break;case n.StarredActionTypes.RENAME_EXTERNAL_RESOURCE:this.onRenameExternalResource(t.id,t.name),this.__emitChange()}},t})(l.FluxStore);t.PrivateStarredResourceStoreClass=m;var S=null;t.getStarredResourceStore=p}),define("modules/clean/react/home/starred/starred_view",["require","exports","tslib","external/react","modules/clean/react/home/store","modules/clean/react/home/util/logging/timing_logger","modules/clean/react/home/util/logging/timing_component","modules/clean/react/home/util/show_hide_link","modules/clean/react/home/constants","modules/clean/react/home/starred/starred_item","modules/clean/react/home/actions","modules/clean/react/home/store","modules/clean/react/home/util/logging/activity_logger","modules/clean/react/home/starred/starred_resource_store","modules/clean/react/home/starred/starred_empty_state","modules/clean/react/home/post_tti/api","modules/clean/react/home/store","modules/clean/react/home/starred/starred_helper_components","modules/clean/react/home/util/post_tti_components"],function(e,t,r,a,o,s,n,i,c,d,l,u,p,m,S,h,_,g,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){function t(){var t=e.call(this)||this;return t.onStoreUpdate=function(){return t.setState(t.getStateFromStore())},t.toggleShowAll=function(){var e=!t.state.showAll;p.homeActivityLogger.logClickShowAll("starred",!t.state.showAll),e&&t.state.hasMore&&h.waitForHomeTTI().then(function(e){return(0,e.loadAllStarredItems)()}),t.setState({showAll:e})},t.onChangeStarredVisibility=function(){var e=t.props.isHiddenByUser;l.HomeActions.setSectionVisibility(u.getUserId(),{".tag":"starred"},e),p.homeActivityLogger.logShowHideSection(c.HomeSections.STARRED,!e)},t.onTabSelected=function(e){t.setState({activeTab:e})},t.removeStoreListener=m.getStarredResourceStore().addListener(t.onStoreUpdate),t.state=r.__assign({},t.getStateFromStore(),{showAll:!1,user:o.getUser(),activeTab:g.StarredTab.STARRED}),t}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){this.removeStoreListener&&this.removeStoreListener()},t.prototype.getStateFromStore=function(){var e=m.getStarredResourceStore(),t=e.getLoadingState(),r=e.getItems(),a=e.getHasMore(),o=e.getHasLoadedInitial(),n=e.getHasLoadedAll();if(t===c.LoadingStates.SUCCESS){if(s.homeTimingLogger.logTTData(c.HomeSections.STARRED)){var i=r.length>5;p.homeActivityLogger.logStarredShown(r.length,i,a)}}return{itemModels:r,loadingState:t,hasMore:a,hasLoadedInitial:o,hasLoadedAll:n}},t.prototype.renderItems=function(e){return 0===e.length?a.createElement(S.StarredEmptyState,null):a.createElement("ul",{className:"starred-list"},e)},t.prototype.renderLoadingIndicator=function(){return this.state.loadingState!==c.LoadingStates.LOADING||this.state.hasLoadedAll||(this.state.hasLoadedInitial||this.state.itemModels.length)&&!this.state.showAll?null:a.createElement("div",{className:"home-access__loading-indicator home--loading-indicator"},a.createElement("div",{className:"maestro-loading-spinner"}))},t.prototype.getItemListToRender=function(){var e=this,t=this.state.itemModels,r=t.length>5;return r&&!this.state.showAll&&(t=t.slice(0,5)),{items:t.map(function(t,r){return a.createElement(d.StarredItem,{key:t.resourceId,item:t,user:e.state.user,position:r})}),hasHiddenRows:r}},t.prototype.renderShowHideLink=function(e){return e?a.createElement(i.ShowHideLink,{onClick:this.toggleShowAll,isExpanded:this.state.showAll,hiddenItemCount:this.state.itemModels.length-5,canLoadMore:!1}):null},t.prototype.render=function(){var e=this.props,t=e.canRenderItems,r=e.isHiddenByUser,o=_.getHomeStore().getPreTTIProps().shouldShowTasksSection;if(!t)return null;var s;if(r)s=null;else{var n=this.getItemListToRender(),i=n.items,c=n.hasHiddenRows;s=a.createElement("div",{className:"starred-container"},this.renderItems(i),this.renderLoadingIndicator(),this.renderShowHideLink(c))}return a.createElement(g.StarredFrame,null,o?a.createElement(g.StarredTabbedHeader,{onSelection:this.onTabSelected,activeTabId:this.state.activeTab}):a.createElement(S.StarredHeader,{isHiddenByUser:r,buttonAction:this.onChangeStarredVisibility}),o&&this.state.activeTab===g.StarredTab.TODO?a.createElement(T.TasksPostTTIComponent,null):s)},t.displayName="StarredView",t})(a.PureComponent);t.StarredView=n.timingComponent(y,c.HomeSections.STARRED)}),define("modules/clean/react/starred/actions",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/starred/constants","modules/clean/react/starred/api","modules/clean/react/starred/model"],function(e,t,r,a,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}return e.fetchStatuses=function(t,n,i){return void 0===i&&(i=!1),i||e.markAsLoading(n),o.fetchStatuses(t,n).then(function(e){r.Dispatcher.dispatch({type:a.StarredActionTypes.SET_STATUS,starredStatuses:s.statusResultsToStarredStatuses(e)})}).catch(function(e){return r.Dispatcher.dispatch({type:a.StarredActionTypes.LOAD_FAILURE,idTypePairs:n}),Promise.reject(e)})},e.markAsLoading=function(e){r.Dispatcher.dispatch({type:a.StarredActionTypes.LOADING,idTypePairs:e})},e.renameExternalResource=function(e,t,s){r.Dispatcher.dispatch({type:a.StarredActionTypes.RENAME_EXTERNAL_RESOURCE,id:e,name:s});var n=o.updateExternalResource(e,s,!0);return n.catch(function(o){throw r.Dispatcher.dispatch({type:a.StarredActionTypes.RENAME_EXTERNAL_RESOURCE,id:e,name:t}),o}),n},e.update=function(e,t,s,n,i,c){var d={id:t,type:s};r.Dispatcher.dispatch({type:a.StarredActionTypes.LOADING,idTypePairs:[d]});var l,u;if(s===a.IdTypes.EXTERNAL_RESOURCE_ID){if(null===i||void 0===i)throw new TypeError("Name of external resource cannot be null/undefined");u=o.updateExternalResource(t,i,n,c)}else u=o.update(e,t,s,n);return u.then(function(){return l=n}).catch(function(e){throw l=!n,e}).finally(function(){r.Dispatcher.dispatch({type:a.StarredActionTypes.SET_STATUS,starredStatuses:[{idTypePair:{id:t,type:s},starred:l}]});var e={url:t,name:i,isStarred:n};window.chrome&&window.chrome.runtime&&window.chrome.runtime.sendMessage(a.StarExtensionId_PROD,e)}),u},e})();t.StarredActions=n}),define("modules/clean/react/starred/api",["require","exports","modules/clean/ajax"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t,a){return new Promise(function(o,s){(a?r.SilentBackgroundRequest:r.WebRequest)({url:e,type:"POST",dataType:"json",data:t,success:o,error:function(e,t,r){return s(Error("error: "+r+", status: "+t))}})})};t.fetchStatuses=function(e,t){return a("/starred/get_status",{role:e,resources_json:JSON.stringify(t)},!0)},t.update=function(e,t,r,o){return a("/starred/update",{role:e,resource_id:t,id_type:r,is_starred:o})},t.updateExternalResource=function(e,t,r,o){return a("/starred/update_external_resource",{url:e,name:t,is_starred:r,favicon_url:o})}}),define("modules/clean/react/starred/model",["require","exports"],function(e,t){"use strict";function r(e){return e.map(function(e){var t=e.id,r=e.type,a=e.is_starred,o=e.canonical_id,s=e.canonical_id_type,n={idTypePair:{id:t,type:r},starred:a};return o&&s&&(n.canonicalIdTypePair={id:o,type:s}),n})}Object.defineProperty(t,"__esModule",{value:!0}),t.statusResultsToStarredStatuses=r}),define("modules/clean/react/starred/star",["require","exports","tslib","external/classnames","external/react","modules/clean/react/starred/starred_activity_logger","modules/clean/react/css","modules/clean/react/starred/actions","modules/clean/react/starred/store","modules/clean/react/title_bubble","modules/core/i18n","modules/core/notify","spectrum/icon_star"],function(e,t,r,a,o,s,n,i,c,d,l,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){function t(t){var r=e.call(this,t)||this;return r.onStoreUpdate=function(){var e=r.getStateFromStore();r.setState(e)},r.onClick=function(e){if(e.stopPropagation(),e.preventDefault(),!r.state.isLoading){var t=!r.state.isStarred;s.starredActivityLogger.logClick(r.props.user,r.props.id,r.props.idType,r.props.source,t),r.props.onStarClick&&r.props.onStarClick(t),i.StarredActions.update(r.props.user.role,r.props.id,r.props.idType,t,r.props.itemName).catch(function(e){var a;a=r.props.itemName?t?l._("There was a problem starring %(item_name)s").format({item_name:r.props.itemName}):l._("There was a problem unstarring %(item_name)s").format({item_name:r.props.itemName}):t?l._("There was a problem starring your selection"):l._("There was a problem unstarring your selection"),u.Notify.error(a)})}},r.state=r.getStateFromStore(),r.removeStoreListener=c.StarredStore.addListener(r.onStoreUpdate),r}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){this.removeStoreListener&&this.removeStoreListener()},t.prototype.componentWillReceiveProps=function(e){this.props.id===e.id&&this.props.idType===e.idType||this.setState(this.getStateFromStore(e))},t.prototype.getStateFromStore=function(e){void 0===e&&(e=this.props);var t={id:e.id,type:e.idType};return{isLoading:c.StarredStore.getIsLoading(t),isStarred:c.StarredStore.getIsStarred(t)}},t.prototype.getTooltipContent=function(){return this.props.isReadOnly?this.state.isStarred?l._("Starred"):null:this.state.isStarred?l._("Remove from Starred"):l._("Add to Starred")},t.prototype.render=function(){if(void 0===this.state.isStarred)return null;if(this.props.isReadOnly&&!this.state.isStarred)return null;var e={star__toggle:!0,"star__toggle--starred":this.state.isStarred,"star__toggle--unstarred":!this.state.isStarred&&!this.props.isTabbing,"star__toggle--loading":this.state.isLoading};return o.createElement(d.TitleBubble,{content:this.getTooltipContent(),position:this.props.tooltipPosition},o.createElement("button",{className:a(e),role:"button","aria-pressed":this.state.isStarred,"aria-label":"Star",onClick:this.onClick,onDoubleClick:this.onClick,disabled:this.props.isReadOnly},o.createElement(p.IconStar,{selected:this.state.isStarred||this.state.isLoading})))},t.displayName="Star",t.defaultProps={tooltipPosition:d.TitleBubble.POSITIONS.TOP},t})(o.PureComponent);t.Star=n(m,["/static/css/starred/star-vflY8zJ8O.css"])}),define("modules/clean/react/starred/starred_activity_logger",["require","exports","modules/clean/react/home/api","modules/clean/react/home/starred/constants","modules/clean/react/starred/constants","modules/clean/web_user_action_logger","modules/clean/web_user_action_events"],function(e,t,r,a,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=[o.StarredSource.HOME_STARRED,o.StarredSource.HOME_RECENTS],c=(function(){function e(){}return e.prototype.logClick=function(e,t,o,c,d){if("BROWSE"===c)return Promise.resolve();var l=[];if(i.includes(c)){var u=d?a.StarredLoggingTypes.CLICK_STAR:a.StarredLoggingTypes.CLICK_UNSTAR;l.push(r.logHomeActivity({eventName:u,role:e.role,extra:{resource_id:t,id_type:o}}))}var p=d?n.WebUserActionLogEvent.STAR:n.WebUserActionLogEvent.REMOVE_STAR;return l.push(s.WebUserActionLog.log(e.id,p,{resource_id:t,id_type:o,role:e.role,source:c})),Promise.all(l)},e})();t.StarredActivityLogger=c,t.starredActivityLogger=new c}),define("modules/clean/react/starred/store",["require","exports","tslib","external/lodash","modules/clean/flux/dispatcher","modules/clean/flux/flux_store","modules/clean/react/starred/constants","modules/clean/react/home/starred/constants","modules/clean/react/starred/id_type_pair"],function(e,t,r,a,o,s,n,i,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(){var t=e.call(this,o.Dispatcher)||this;return t.idsToLoadingState={},t.idsToStarred={},t}return r.__extends(t,e),t.prototype.getLoadingStates=function(){return this.idsToLoadingState},t.prototype.hasIdTypePair=function(e){return this.idsToLoadingState.hasOwnProperty(c.idTypePairToString(e))},t.prototype.getLoadingState=function(e){return this.idsToLoadingState[c.idTypePairToString(e)]},t.prototype.getIsStarred=function(e){return this.idsToStarred[c.idTypePairToString(e)]},t.prototype.getAllStarredPairStrings=function(){return Object.keys(a.pickBy(this.idsToStarred,function(e){return e}))},t.prototype.getIsLoading=function(e){return this.getLoadingState(e)===n.StarredLoadingState.LOADING},t.prototype.onLoading=function(e){var t={};e.forEach(function(e){return t[c.idTypePairToString(e)]=n.StarredLoadingState.LOADING}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,t)},t.prototype.onSetStatus=function(e){void 0===e&&(e=[]);var t={},a={};e.forEach(function(e){var r=c.idTypePairToString(e.idTypePair);t[r]=n.StarredLoadingState.LOAD_SUCCESS,a[r]=e.starred}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,t),this.idsToStarred=r.__assign({},this.idsToStarred,a)},t.prototype.onLoadFailure=function(e){var t=this,a={};e.forEach(function(e){var r=c.idTypePairToString(e),o=t.idsToLoadingState[r];void 0!==o&&o!==n.StarredLoadingState.LOADING||(a[r]=n.StarredLoadingState.LOAD_FAILED)}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,a)},t.prototype.__onDispatch=function(e){var t=e.action;switch(t.type){case n.StarredActionTypes.LOADING:this.onLoading(t.idTypePairs),this.__emitChange();break;case n.StarredActionTypes.SET_STATUS:case i.StarredResourceActionTypes.LOAD_SUCCESS:this.onSetStatus(t.starredStatuses),this.__emitChange();break;case n.StarredActionTypes.LOAD_FAILURE:this.onLoadFailure(t.idTypePairs),this.__emitChange();break;default:return}},t})(s.FluxStore);t._StarredStoreClass=d,t.StarredStore=new d}),define("spectrum/icon_star",["require","exports","tslib","spectrum/icon_star/index"],function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(a,t)}),define("spectrum/icon_star/icon_star",["require","exports","tslib","react","classnames","spectrum/icon_bundles/action"],function(e,t,r,a,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICONS=s.ICONS,t.IconStar=function(e){var t=e.state,n=e.selected,i=e.className,c=(e.ref,r.__rest(e,["state","selected","className","ref"])),d=n?s.ICONS.unstar:s.ICONS.star,l=d.attrs,u=d.innerHtml,p=o("mc-icon-star",{"mc-icon-star-selected":n,"mc-icon-star-hovered":"hovered"===t,"mc-icon-star-active":"active"===t,"mc-icon-star-disabled":"disabled"===t},i);return a.createElement("svg",r.__assign({},l,{className:p,dangerouslySetInnerHTML:{__html:u}},c))},t.IconStar.displayName="IconStar"}),define("spectrum/icon_star/index",["require","exports","tslib","spectrum/icon_star/icon_star"],function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(a,t)});
//# sourceMappingURL=pkg-starred.min.js-vflbltDkK.map