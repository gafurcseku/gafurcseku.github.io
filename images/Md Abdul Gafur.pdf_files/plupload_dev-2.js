define(["external/moxie"],function(e){return(function(e,t,r){function i(e){function t(e,t,r){var n={chunks:"slice_blob",resize:"send_binary_string",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",max_file_size:"access_binary",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};n[e]?i[n[e]]=t:r||(i[e]=t)}var r=e.required_features,i={};return"string"==typeof r?o.each(r.split(/\s*,\s*/),function(e){t(e,!0)}):"object"==typeof r?o.each(r,function(e,r){t(r,e)}):r===!0&&(e.multipart||(i.send_binary_string=!0),e.chunk_size>0&&(i.slice_blob=!0),o.each(e,function(e,r){t(r,!!e,!0)})),i}var n=e.setTimeout,s={},o={VERSION:"2.0.0beta",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,OVER_QUOTA_ERROR:-708,BLOCKS_MISSING_ERROR:-703,COMMIT_HTTP_ERROR:-704,UPLOAD_BLOCK_ERROR:-705,CHUNKS_NOT_ENABLED_ERROR:-706,SERVER_HASH_RESPONSE_ERROR:-707,BLOCK_RUNTIME_ID_MISSING:-709,CLIENT_HASH_EMPTY_ERROR:-710,SERVER_HASH_EMPTY_ERROR:-711,HASHES_NOT_EQUAL_ERROR:-712,BLOCK_INDEX_ERROR:-713,BLOCK_EMPTY_ERROR:-714,BLOB_EMPTY_ERROR:-715,CLIENT_HASH_DIGEST_ERROR:-716,FILE_READER_NULL_RESULT_ERROR:-717,COMMIT_READINESS_ERROR:-718,mimeTypes:t.mimes,ua:t.ua,typeOf:t.typeOf,extend:t.extend,guid:t.guid,each:t.each,getPos:t.getPos,getSize:t.getSize,xmlEncode:function(e){var t={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"};return e?(""+e).replace(/[<>&\"\']/g,function(e){return t[e]?"&"+t[e]+";":e}):e},toArray:t.toArray,inArray:t.inArray,addI18n:t.addI18n,translate:t.translate,isEmptyObj:t.isEmptyObj,hasClass:t.hasClass,addClass:t.addClass,removeClass:t.removeClass,getStyle:t.getStyle,addEvent:t.addEvent,removeEvent:t.removeEvent,removeAllEvents:t.removeAllEvents,cleanName:function(e){var t,r;for(r=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],t=0;t<r.length;t+=2)e=e.replace(r[t],r[t+1]);return e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(e,t){var r="";return o.each(t,function(e,t){r+=(r?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),r&&(e+=(e.indexOf("?")>0?"&":"?")+r),e},formatSize:function(e){return void 0===e||/\D/.test(e)?o.translate("N/A"):e>1099511627776?Math.round(e/1099511627776,1)+" "+o.translate("tb"):e>1073741824?Math.round(e/1073741824,1)+" "+o.translate("gb"):e>1048576?Math.round(e/1048576,1)+" "+o.translate("mb"):e>1024?Math.round(e/1024,1)+" "+o.translate("kb"):e+" "+o.translate("b")},parseSize:t.parseSizeStr,predictRuntime:function(e,t){var r,i;return t&&(e.runtimes=t),r=new o.Uploader(e),i=r.runtime,r.destroy(),i},addFileFilter:function(e,t){s[e]=t}};o.addFileFilter("mime_types",(function(){function e(e){var t=[];return o.each(e,function(e){o.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?t.push("\\.*"):t.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+t.join("|")+")$","i")}var t,r;return function(i,n,s){r&&i==t||(r=e(i),t=[].slice.call(i)),r.test(n.name)?s(!0):(this.trigger("Error",{code:o.FILE_EXTENSION_ERROR,message:o.translate("File extension error."),file:n}),s(!1))}})()),o.addFileFilter("max_file_size",function(e,t,r){void 0!==t.size&&e&&t.size>e?(this.trigger("Error",{code:o.FILE_SIZE_ERROR,message:o.translate("File size error."),file:t}),r(!1)):r(!0)}),o.addFileFilter("prevent_duplicates",function(e,t,r){if(e)for(var i=this.files.length;i--;)if(t.name===this.files[i].name&&t.size===this.files[i].size)return this.trigger("Error",{code:o.FILE_DUPLICATE_ERROR,message:o.translate("Duplicate file error."),file:t}),void r(!1);r(!0)}),o.Uploader=function(r){function a(){var e,t,i=0;if(r.parallel_uploads)for(t=0;t<E.length;t++)if(E[t].status==o.UPLOADING)return;if(this.state==o.STARTED){for(t=0;t<E.length;t++)e||E[t].status!=o.QUEUED?i++:(e=E[t],this.trigger("BeforeUpload",e)&&(e.status=o.UPLOADING,this.trigger("UploadFile",e)));i==E.length&&(this.state!==o.STOPPED&&(this.state=o.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",E))}}function l(e){e.percent=e.size>0?Math.ceil(e.loaded/e.size*100):100,u()}function u(){var e,t;for(p.reset(),e=0;e<E.length;e++)t=E[e],void 0!==t.size?(p.size+=t.origSize,p.loaded+=t.loaded*t.origSize/t.size):p.size=void 0,t.status==o.DONE?p.uploaded++:t.status==o.FAILED?p.failed++:p.queued++;void 0===p.size?p.percent=E.length>0?Math.ceil(p.uploaded/E.length*100):0:(p.bytesPerSec=Math.ceil(p.loaded/((+new Date-_||1)/1e3)),p.percent=p.size>0?Math.ceil(p.loaded/p.size*100):0)}function d(){var e=this,i=0,n={accept:r.filters.mime_types,runtime_order:r.runtimes,required_caps:S,swf_url:r.flash_swf_url,xap_url:r.silverlight_xap_url};o.each(r.runtimes.split(/\s*,\s*/),function(e){r[e]&&(n[e]=r[e])}),t.inSeries([function(s){r.browse_button?(R=new t.FileInput(o.extend({},n,{name:r.file_data_name,multiple:r.multi_selection,container:r.container,browse_button:r.browse_button})),R.onready=function(){var r=t.Runtime.getInfo(this.ruid);t.extend(e.features,{chunks:r.can("slice_blob"),multipart:r.can("send_multipart"),multi_selection:r.can("select_multiple")}),i++,s()},R.onchange=function(){e.addFile(this.files)},R.bind("mouseenter mouseleave mousedown mouseup",function(e){if(!y){var i=t.get(r.browse_button);i&&(r.browse_button_hover&&("mouseenter"===e.type?t.addClass(i,r.browse_button_hover):"mouseleave"===e.type&&t.removeClass(i,r.browse_button_hover)),r.browse_button_active&&("mousedown"===e.type?t.addClass(i,r.browse_button_active):"mouseup"===e.type&&t.removeClass(i,r.browse_button_active)),i=null)}}),R.bind("mousedown",function(){e.trigger("Browse")}),R.bind("error runtimeerror",function(){R=null,s()}),R.init()):s()},function(s){r.drop_element?(h=new t.FileDrop(o.extend({},n,{drop_zone:r.drop_element})),h.onready=function(){var r=t.Runtime.getInfo(this.ruid);e.features.dragdrop=r.can("drag_and_drop"),i++,s()},h.ondrop=function(){e.trigger("DragAndDrop"),e.addFile(this.files)},h.bind("error runtimeerror",function(){h=null,s()}),h.init()):s()}],function(){"function"==typeof r.init?r.init(e):o.each(r.init,function(t,r){e.bind(r,t)}),i?e.trigger("PostInit"):e.trigger("Error",{code:o.INIT_ERROR,message:o.translate("Init error.")})})}function c(e,r){if(e.ruid){var i=t.Runtime.getInfo(e.ruid);if(i)return i.can(r)}return!1}function f(e,r,i){var n=new t.Image;try{n.onload=function(){n.downsize(r.width,r.height,r.crop,r.preserve_headers)},n.onresize=function(){i(this.getAsBlob(e.type,r.quality)),this.destroy()},n.onerror=function(){i(e)},n.load(e)}catch(t){i(e)}}var g,_,p,R,h,m,E=[],v={},b=!1,O={},S={},y=!1;p=new o.QueueProgress,r=o.extend({runtimes:t.Runtime.order,max_retries:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",send_chunk_number:!0},r),r.resize&&(r.resize=o.extend({preserve_headers:!0,crop:!1},r.resize)),"array"===o.typeOf(r.filters)&&(r.filters={mime_types:r.filters}),r.filters=o.extend({mime_types:[],prevent_duplicates:!!r.prevent_duplicates,max_file_size:r.max_file_size},r.filters),r.filters.max_file_size=o.parseSize(r.filters.max_file_size)||0,r.chunk_size=o.parseSize(r.chunk_size)||0,r.required_features=S=i(o.extend({},r)),o.extend(this,{id:o.guid(),state:o.STOPPED,features:{},runtime:t.Runtime.thatCan(S,r.runtimes),files:E,settings:r,total:p,init:function(){function i(e){Object.keys(e).forEach(function(t){e[t].abort()})}function s(){i(v),v={}}var p=this;if(r.browse_button=t.get(r.browse_button),r.drop_element=t.get(r.drop_element),"function"==typeof r.preinit?r.preinit(p):o.each(r.preinit,function(e,t){p.bind(t,e)}),!r.browse_button||!r.url)return void this.trigger("Error",{code:o.INIT_ERROR,message:o.translate("Init error.")});p.bind("FilesAdded",function(e,t){[].push.apply(E,t),n(function(){p.trigger("QueueChanged"),p.refresh()},1)}),p.bind("CancelUpload",function(){r.parallel_uploads?(g&&g.abort(),b=!0,s()):m&&m.abort()}),r.unique_names&&p.bind("BeforeUpload",function(e,t){var r=t.name.match(/\.([^.]+)$/),i="part";r&&(i=r[1]),t.target_name=t.id+"."+i}),p.bind("UploadFile",function(a,l){function u(){507!==m.status&&O-- >0?n(d,1):(l.loaded=y,a.trigger("Error",{code:o.HTTP_ERROR,message:o.translate("HTTP Error."),file:l,response:m.responseText,status:m.status,responseHeaders:m.getAllResponseHeaders()}))}function d(){var e,i,s,c;l.status!=o.DONE&&l.status!=o.FAILED&&a.state!=o.STOPPED&&(s={name:l.target_name||l.name},E&&h.chunks&&p.size>E?(c=Math.min(E,p.size-y),e=p.slice(y,y+c)):(c=p.size,e=p),E&&h.chunks?r.send_chunk_number?(s.chunk=Math.ceil(y/E),s.chunks=Math.ceil(p.size/E)):(s.offset=y,s.total=p.size):(s.chunk=0,s.chunks=1),m=new t.XMLHttpRequest,m.withCredentials=!0,m.upload&&(m.upload.onprogress=function(e){l.loaded=Math.min(l.size,y+e.loaded),a.trigger("UploadProgress",l,!0)}),m.onload=function(){if(m.status>=400)return void u();c<p.size?(e.destroy(),y+=c,l.loaded=Math.min(y,p.size),a.trigger("ChunkUploaded",l,{offset:l.loaded,total:p.size,response:m.responseText,status:m.status,responseHeaders:m.getAllResponseHeaders()}),"Android Browser"===t.Env.browser&&a.trigger("UploadProgress",l,!0)):l.loaded=l.size,e=i=null,!y||y>=p.size?(l.size!=l.origSize&&(p.destroy(),p=null),a.trigger("UploadProgress",l,!0),l.status=o.DONE,a.trigger("FileUploaded",l,{response:m.responseText,status:m.status,responseHeaders:m.getAllResponseHeaders()})):(O=r.max_retries,n(d,1))},m.onerror=function(){u()},m.onloadend=function(){this.destroy(),m=null},a.settings.multipart&&h.multipart?(s.name=l.target_name||l.name,m.open("post",R,!0),o.each(a.settings.headers,function(e,t){m.setRequestHeader(t,e)}),i=new t.FormData,o.each(o.extend(s,a.settings.multipart_params),function(e,t){i.append(t,e)}),i.append(a.settings.file_data_name,e),m.send(i,{runtime_order:a.settings.runtimes,required_caps:S,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})):(R=o.buildUrl(a.settings.url,o.extend(s,a.settings.multipart_params)),m.open("post",R,!0),m.setRequestHeader("Content-Type","application/octet-stream"),o.each(a.settings.headers,function(e,t){m.setRequestHeader(t,e)}),m.send(e,{runtime_order:a.settings.runtimes,required_caps:S,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})))}function _(){function r(e){var t;if(z<=E)t=p;else{var r=e*E,i=Math.min(E,z-r);t=p.slice(r,r+i)}return t&&0!==t.size?t:(s(),void a.trigger("Error",{code:o.BLOCK_EMPTY_ERROR,message:o.translate("Block is empty."),file:l,blockIndex:e}))}function u(){return A===D&&w.length===D&&!w.includes(void 0)}function d(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function c(e){for(;e.endsWith("=");)e=e.slice(0,-1);return e}function f(e){return e.replace(/\//g,"_").replace(/\+/g,"-")}function _(e){function t(i){var n=r(i);if(!n.ruid)return s(),void a.trigger("Error",{code:o.BLOCK_RUNTIME_ID_MISSING_ERROR,message:o.translate("Block ruid missing."),file:l});n.connectRuntime(n.ruid);var u=new FileReader;g=u,u.onloadend=function(r){if(!r.target.result&&!b)return s(),void a.trigger("Error",{code:o.FILE_READER_NULL_RESULT_ERROR,message:o.translate("File reader null result."),file:l,blockIndex:i});var u=crypto.subtle.digest("SHA-256",r.target.result);n.disconnectRuntime(),u.then(function(r){var n=btoa(String.fromCharCode.apply(null,new Uint8Array(r))),u=f(n);if(u=c(u),!u&&!b)return s(),void a.trigger("Error",{code:o.CLIENT_HASH_EMPTY_ERROR,message:o.translate("Client hash empty or undefined error."),file:l});P[i]=u,i++,l.loaded+=1e4,a.trigger("UploadProgress",l,!1),i>=D?(l.loaded=0,e()):t(i)}).catch(function(e){if(!b)return s(),void a.trigger("Error",{code:o.CLIENT_HASH_DIGEST_ERROR,message:o.translate(e),file:l,blockIndex:i})})};var d=n.getSource();u.readAsArrayBuffer(d)}t(0)}function m(){for(var e=0;e<6&&e<D;e++)T=e,S(e)}function O(e,t){if(!(507!==t.status&&C[e]<a.settings.max_retries))return l.loaded=0,s(),void a.trigger("Error",{code:o.UPLOAD_BLOCK_ERROR,message:o.translate("Upload block HTTP error."),file:l,response:t.responseText,status:t.status,responseHeaders:t.getAllResponseHeaders()});n(function(){S(e)},2e3),C[e]++}function S(e){var i=r(e),n=new t.XMLHttpRequest;n.withCredentials=!0;var c={};c._subject_uid=a.settings.multipart_params._subject_uid,c.t=a.settings.multipart_params.t,c.num_blocks=D,c.reported_block_size=i.size,void 0!==a.settings.multipart_params.ns_id_for_routing&&(c.ns_id_for_routing=a.settings.multipart_params.ns_id_for_routing);var f=0;n.upload?n.upload.onprogress=function(e){e.loaded&&(l.loaded+=e.loaded-f,f=e.loaded,a.trigger("UploadProgress",l,!0))}:n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&200===n.status&&(l.loaded+=i.size,a.trigger("UploadProgress",l,!0))},n.onload=function(){if(n.status>=400)return void O(e,n);var t;try{t=JSON.parse(n.response).block_hash}catch(t){return s(),void a.trigger("Error",{code:o.SERVER_HASH_RESPONSE_ERROR,message:o.translate("Block hash response error."),file:l,blockIndex:e})}if(!t)return s(),void a.trigger("Error",{code:o.SERVER_HASH_EMPTY_ERROR,message:o.translate("Server hash empty or undefined error."),file:l,blockIndex:e});if(I){if(t!==P[e])return s(),void a.trigger("Error",{code:o.HASHES_NOT_EQUAL_ERROR,message:o.translate("Client and server hashes not equal error."),file:l,blockIndex:e});w[e]=t,A++,delete v[e]}else w[e]=t,A++,delete v[e];if(T<D-1)T++,S(T);else{if(T>D)return s(),void a.trigger("Error",{code:o.BLOCK_INDEX_ERROR,message:o.translate("Block index error."),file:l,blockIndex:e});if(u()){if(I&&!d(w,P))return s(),void a.trigger("Error",{code:o.HASHES_NOT_EQUAL_ERROR,message:o.translate("Client and server hashes not equal error."),file:l,blockIndex:e});y(w)}else if(T===D-1&&!Object.keys(v).length&&!u())return s(),void a.trigger("Error",{code:o.COMMIT_READINESS_ERROR,message:o.translate("Done iterating over blocks, but no requests in progress or outstanding and not ready to commit."),file:l})}},n.onerror=function(){O(e,n)},n.onloadend=function(){delete v[e],this.destroy(),n=null},R=o.buildUrl(a.settings.upload_block_url,c),n.open("post",R,!0),n.setRequestHeader("Content-Type","application/octet-stream"),o.each(a.settings.headers,function(e,t){n.setRequestHeader(t,e)}),v[e]=n,n.send(i),C[e]++}function y(e){function r(e){if(!(507!==e.status&&d<a.settings.max_retries))return l.loaded=0,i(v),v={},void a.trigger("Error",{code:o.COMMIT_HTTP_ERROR,message:o.translate("Commit HTTP error."),file:l,response:e.responseText,status:e.status,responseHeaders:e.getAllResponseHeaders()});n(function(){u()},8e3),d++}function u(){var i=new t.XMLHttpRequest;if(i.withCredentials=!0,i.onload=function(){if(i.status>=400)return void r(i);i.readyState===XMLHttpRequest.DONE&&200===i.status&&(l.size!=l.origSize&&(p.destroy(),p=null),a.trigger("UploadProgress",l,!0),l.status=o.DONE,a.trigger("FileUploaded",l,{response:i.responseText,status:i.status,responseHeaders:i.getAllResponseHeaders()}),v={})},i.onerror=function(){r(i)},i.onloadend=function(){v={},this.destroy(),i=null},R=o.buildUrl(a.settings.commit_file_url,c),i.open("post",R,!0),i.setRequestHeader("Content-Type","application/octet-stream"),o.each(a.settings.headers,function(e,t){i.setRequestHeader(t,e)}),v.commitRequest=i,1!==Object.keys(v).length||!v.hasOwnProperty("commitRequest"))return s(),void a.trigger("Error",{code:o.COMMIT_READINESS_ERROR,message:o.translate("In commitFile call, but more than 1 request in progress or requestsInProgress map lacks the commit request."),file:l});i.send(e),d++}var d=0,c={};if(c._subject_uid=a.settings.multipart_params._subject_uid,c.t=a.settings.multipart_params.t,c.dest=a.settings.multipart_params.dest,c.name=l.target_name||l.name,c.overwrite=a.settings.multipart_params.overwrite,c.reported_total_size=a.settings.multipart_params.reported_total_size,e.length!==D)return void a.trigger("Error",{code:o.BLOCKS_MISSING_ERROR,message:o.translate("Blocks missing error."),file:l});u()}var I=!!(e.crypto&&e.crypto.subtle&&e.crypto.subtle.digest);if(!p.size)return void a.trigger("Error",{code:o.BLOB_EMPTY_ERROR,message:o.translate("Blob size is 0 bytes."),file:l});var T,z=p.size,A=0,D=Math.ceil(z/E),C=[],w=[],P=[];if(l.status!=o.DONE&&l.status!=o.FAILED&&a.state!=o.STOPPED){if(!h.chunks)return void a.trigger("Error",{code:o.CHUNKS_NOT_ENABLED_ERROR,message:o.translate("Chunks not enabled error."),file:l});for(var L=0;L<D;L++)w.push(void 0),P.push(void 0),C.push(0);I?_(function(){m()}):m()}}var p,R=a.settings.url,h=a.features,E=r.chunk_size,O=r.max_retries,y=0;l.loaded&&(y=l.loaded=E*Math.floor(l.loaded/E)),p=l.getSource(),!t.isEmptyObj(a.settings.resize)&&c(p,"send_binary_string")&&~t.inArray(p.type,["image/jpeg","image/png"])?f.call(this,p,a.settings.resize,function(e){p=e,l.size=e.size,r.parallel_uploads?_():d()}):r.parallel_uploads?_():d()}),p.bind("UploadProgress",function(e,t,r){l(t)}),p.bind("StateChanged",function(e){if(e.state==o.STARTED)_=+new Date;else if(e.state==o.STOPPED)for(var t=e.files.length-1;t>=0;t--)e.files[t].status==o.UPLOADING&&(e.files[t].status=o.QUEUED,u())}),p.bind("QueueChanged",u),p.bind("Error",function(e,t){t.file&&(t.file.status=o.FAILED,l(t.file),e.state==o.STARTED&&n(function(){a.call(p)},1))}),p.bind("FileUploaded",function(){u(),n(function(){a.call(p)},1)}),p.trigger("Init",{runtime:this.runtime}),d.call(this)},refresh:function(){R&&R.trigger("Refresh"),this.trigger("Refresh")},start:function(){this.state!=o.STARTED&&(this.state=o.STARTED,this.trigger("StateChanged"),a.call(this))},stop:function(){this.state!=o.STOPPED&&(this.state=o.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){y=void 0===arguments[0]||arguments[0],R&&R.disable(y),this.trigger("DisableBrowse",y)},getFile:function(e){var t;for(t=E.length-1;t>=0;t--)if(E[t].id===e)return E[t]},addFile:function(e,r){function i(){var e=h||R;return!!e&&e.getRuntime().uid}function a(e,r){var i=[];t.each(d.settings.filters,function(t,r){s[r]&&i.push(function(i){s[r].call(d,t,e,function(e){i(!e)})})}),t.inSeries(i,r)}function l(e){var i=t.typeOf(e);if(e instanceof t.File){if(!e.ruid&&!e.isDetached()){if(!u)return!1;e.ruid=u,e.connectRuntime(u)}const s=new o.File(e);s.batchId=e.batchId,l(s)}else if(e instanceof t.Blob)l(e.getSource()),e.destroy();else if(e instanceof o.File)r&&(e.dest=r),c.push(function(t){a(e,function(r){r||f.push(e),n(t,1)})});else if(t.inArray(i,["file","blob"])!==-1){const d=new t.File(null,e);d.batchId=e.batchId,l(d)}else"node"===i&&"filelist"===t.typeOf(e.files)?t.each(e.files,l):"array"===i&&t.each(e,l)}var u,d=this,c=[],f=[];u=i(),l(e),c.length&&t.inSeries(c,function(){f.length&&d.trigger("FilesAdded",f)})},removeFile:function(e){for(var t="string"==typeof e?e:e.id,r=E.length-1;r>=0;r--)if(E[r].id===t)return this.splice(r,1)[0]},splice:function(e,t){var r=E.splice(void 0===e?0:e,void 0===t?E.length:t);return this.trigger("FilesRemoved",r),this.trigger("QueueChanged"),o.each(r,function(e){e.destroy()}),r},trigger:function(e){var t,r,i=O[e.toLowerCase()];if(i)for(r=Array.prototype.slice.call(arguments),r[0]=this,t=0;t<i.length;t++)if(i[t].func.apply(i[t].scope,r)===!1)return!1;return!0},hasEventListener:function(e){return!!O[e.toLowerCase()]},bind:function(e,t,r){var i;e=e.toLowerCase(),i=O[e]||[],i.push({func:t,scope:r||this}),O[e]=i},unbind:function(e){e=e.toLowerCase();var t,r=O[e],i=arguments[1];if(r){if(void 0!==i){for(t=r.length-1;t>=0;t--)if(r[t].func===i){r.splice(t,1);break}}else r=[];r.length||delete O[e]}},unbindAll:function(){var e=this;o.each(O,function(t,r){e.unbind(r)})},destroy:function(){this.stop(),o.each(E,function(e){e.destroy()}),E=[],R&&(R.destroy(),R=null),h&&(h.destroy(),h=null),S={},_=p=y=m=null,this.trigger("Destroy"),this.unbindAll(),O={}}})},o.File=(function(){function e(e){o.extend(this,{id:o.guid(),name:e.name||e.fileName,dest:"",type:e.type||"",size:e.size||e.fileSize,origSize:e.size||e.fileSize,loaded:0,percent:0,status:o.QUEUED,lastModifiedDate:e.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var e=this.getSource().getSource();return t.inArray(t.typeOf(e),["blob","file"])!==-1?e:null},getSource:function(){return r[this.id]?r[this.id]:null},destroy:function(){var e=this.getSource();e&&(e.destroy(),delete r[this.id])}}),r[this.id]=e}var r={};return e})(),o.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},e.plupload=o})(window,e),window.plupload}.bind(Object.create(null)));
//# sourceMappingURL=plupload_dev-2.0.0.min.js-vfl6UPGbo.map